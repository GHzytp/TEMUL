

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>API documentation &mdash; TEMUL Toolkit v0.1-alpha documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'./',
              VERSION:'v0.1-alpha',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Interactive Image Filtering" href="dg_visualiser_tutorial.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> TEMUL Toolkit
          

          
          </a>

          
            
            
              <div class="version">
                Version 0.1-alpha
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_temul.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="polarisation_vectors_tutorial.html">Plotting Polarisation and Movement Vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="structure_map_tutorial.html">Plot Lattice Structure Maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="masked_fft_tutorial.html">Masked FFT and iFFT</a></li>
<li class="toctree-l1"><a class="reference internal" href="line_profile_tutorial.html">Line Intensity Profile Comparisons</a></li>
<li class="toctree-l1"><a class="reference internal" href="dg_visualiser_tutorial.html">Interactive Image Filtering</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#classes">Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#model-refiner">Model Refiner</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#modules">Modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#polarisation">Polarisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.element_tools">Element Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.intensity_tools">Intensity Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.model_creation">Model Creation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#image-simulation-functions">Image Simulation Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#signal-processing">Signal Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.signal_plotting">Signal Plotting</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.io">Input/Output (io)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.dummy_data">Dummy Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.example_data">Example Data</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TEMUL Toolkit</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>API documentation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/api_doc.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="api-documentation">
<span id="api-doc"></span><h1>API documentation<a class="headerlink" href="#api-documentation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="model-refiner">
<h3>Model Refiner<a class="headerlink" href="#model-refiner" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="modules">
<h2>Modules<a class="headerlink" href="#modules" title="Permalink to this headline">¶</a></h2>
<div class="section" id="polarisation">
<h3>Polarisation<a class="headerlink" href="#polarisation" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="module-temul.element_tools">
<span id="element-tools"></span><h3>Element Tools<a class="headerlink" href="#module-temul.element_tools" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="temul.element_tools.atomic_radii_in_pixels">
<code class="descclassname">temul.element_tools.</code><code class="descname">atomic_radii_in_pixels</code><span class="sig-paren">(</span><em>sampling</em>, <em>element_symbol</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.element_tools.atomic_radii_in_pixels" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the atomic radius of an element in pixels, scaled by an image sampling</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – sampling of an image in units of nm/pix</li>
<li><strong>element_symbol</strong> (<em>string</em><em>, </em><em>default None</em>) – Symbol of an element from the periodic table of elements</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Half the colavent radius of the input element in pixels</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.element_tools</span> <span class="k">import</span> <span class="n">atomic_radii_in_pixels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_signal</span><span class="p">()</span>
</pre></div>
</div>
<p>pretend it is a 5x5 nm image</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image_sampling</span> <span class="o">=</span> <span class="mi">5</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="c1"># units nm/pix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radius_pix_Mo</span> <span class="o">=</span> <span class="n">atomic_radii_in_pixels</span><span class="p">(</span><span class="n">image_sampling</span><span class="p">,</span> <span class="s1">&#39;Mo&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radius_pix_Mo</span>
<span class="go">4.62</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">radius_pix_S</span> <span class="o">=</span> <span class="n">atomic_radii_in_pixels</span><span class="p">(</span><span class="n">image_sampling</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radius_pix_S</span>
<span class="go">2.28</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.element_tools.combine_element_lists">
<code class="descclassname">temul.element_tools.</code><code class="descname">combine_element_lists</code><span class="sig-paren">(</span><em>lists</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.element_tools.combine_element_lists" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce multiple element_lists into one list of strings from a list of
lists, useful for the <cite>Model Refiner</cite> <cite>flattened_element_list</cite>.</p>
</dd></dl>

<dl class="function">
<dt id="temul.element_tools.get_and_return_element">
<code class="descclassname">temul.element_tools.</code><code class="descname">get_and_return_element</code><span class="sig-paren">(</span><em>element_symbol</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.element_tools.get_and_return_element" title="Permalink to this definition">¶</a></dt>
<dd><p>From the elemental symbol, e.g., ‘H’ for Hydrogen, provides Hydrogen as
a periodictable.core.Element object for further use.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>element_symbol</strong> (<em>string</em>) – Symbol of an element from the periodic table of elements e.g., “C”, “H”</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">A periodictable.core.Element object</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.element_tools</span> <span class="k">import</span> <span class="n">get_and_return_element</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Moly</span> <span class="o">=</span> <span class="n">get_and_return_element</span><span class="p">(</span><span class="n">element_symbol</span><span class="o">=</span><span class="s1">&#39;Mo&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Moly</span><span class="o">.</span><span class="n">symbol</span><span class="p">)</span>
<span class="go">Mo</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Moly</span><span class="o">.</span><span class="n">covalent_radius</span><span class="p">)</span>
<span class="go">1.54</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Moly</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
<span class="go">42</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.element_tools.get_individual_elements_from_element_list">
<code class="descclassname">temul.element_tools.</code><code class="descname">get_individual_elements_from_element_list</code><span class="sig-paren">(</span><em>element_list, split_symbol=['_', '.']</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.element_tools.get_individual_elements_from_element_list" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Examples</p>
<p>Single list</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.element_tools</span> <span class="k">as</span> <span class="nn">tml_el</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Mo_0&#39;</span><span class="p">,</span> <span class="s1">&#39;Ti_3&#39;</span><span class="p">,</span> <span class="s1">&#39;Ti_9&#39;</span><span class="p">,</span> <span class="s1">&#39;Ge_2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_individual_elements_from_element_list</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">element_list</span><span class="p">,</span> <span class="n">split_symbol</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">])</span>
<span class="go">[&#39;Ge&#39;, &#39;Mo&#39;, &#39;Ti&#39;]</span>
</pre></div>
</div>
<p>some complex atomic_columns</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">element_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Mo_0&#39;</span><span class="p">,</span> <span class="s1">&#39;Ti_3.Re_7&#39;</span><span class="p">,</span> <span class="s1">&#39;Ti_9.Re_3&#39;</span><span class="p">,</span> <span class="s1">&#39;Ge_2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_individual_elements_from_element_list</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">element_list</span><span class="p">,</span> <span class="n">split_symbol</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">])</span>
<span class="go">[&#39;Ge&#39;, &#39;Mo&#39;, &#39;Re&#39;, &#39;Ti&#39;]</span>
</pre></div>
</div>
<p>multiple lists in element_list. Used in Model_Refiner if you have more than
one sublattice.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">element_list</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;Ti_7_0&#39;</span><span class="p">,</span> <span class="s1">&#39;Ti_9.Re_3&#39;</span><span class="p">,</span> <span class="s1">&#39;Ge_2&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;B_9&#39;</span><span class="p">,</span> <span class="s1">&#39;B_2.Fe_8&#39;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_individual_elements_from_element_list</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">element_list</span><span class="p">,</span> <span class="n">split_symbol</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">])</span>
<span class="go">[&#39;B&#39;, &#39;Fe&#39;, &#39;Ge&#39;, &#39;Re&#39;, &#39;Ti&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.element_tools.split_and_sort_element">
<code class="descclassname">temul.element_tools.</code><code class="descname">split_and_sort_element</code><span class="sig-paren">(</span><em>element, split_symbol=['_', '.']</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.element_tools.split_and_sort_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts info from input atomic column element configuration
Split an element and its count, then sort the element for
use with other functions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>element</strong> (<em>string</em><em>, </em><em>default None</em>) – element species and count must be separated by the
first string in the split_symbol list.
separate elements must be separated by the second
string in the split_symbol list.</li>
<li><strong>split_symbol</strong> (<em>list of strings</em><em>, </em><em>default</em><em> [</em><em>'_'</em><em>, </em><em>'.'</em><em>]</em>) – The symbols used to split the element into its name
and count.
The first string ‘_’ is used to split the name and count
of the element.
The second string is used to split different elements in
an atomic column configuration.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><em>list of a list with element_split, element_name, element_count, and</em></li>
<li><em>element_atomic_number.</em></li>
<li><em>See examples below</em></li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.element_tools</span> <span class="k">import</span> <span class="n">split_and_sort_element</span>
</pre></div>
</div>
<p>simple atomic column</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">split_and_sort_element</span><span class="p">(</span><span class="n">element</span><span class="o">=</span><span class="s1">&#39;S_1&#39;</span><span class="p">)</span>
<span class="go">[[[&#39;S&#39;, &#39;1&#39;], &#39;S&#39;, 1, 16]]</span>
</pre></div>
</div>
<p>complex atomic column</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">info</span> <span class="o">=</span> <span class="n">split_and_sort_element</span><span class="p">(</span><span class="n">element</span><span class="o">=</span><span class="s1">&#39;O_6.Mo_3.Ti_5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-temul.intensity_tools">
<span id="intensity-tools"></span><h3>Intensity Tools<a class="headerlink" href="#module-temul.intensity_tools" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="temul.intensity_tools.get_pixel_count_from_image_slice">
<code class="descclassname">temul.intensity_tools.</code><code class="descname">get_pixel_count_from_image_slice</code><span class="sig-paren">(</span><em>self</em>, <em>image_data</em>, <em>percent_to_nn=0.4</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.intensity_tools.get_pixel_count_from_image_slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Fid the number of pixels in an area when calling
_get_image_slice_around_atom()</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>image_data</strong> (<em>Numpy 2D array</em>) – </li>
<li><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.40</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">The number of pixels in the image_slice</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.intensity_tools</span> <span class="k">import</span> <span class="n">get_pixel_count_from_image_slice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom0</span> <span class="o">=</span> <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pixel_count</span> <span class="o">=</span> <span class="n">get_pixel_count_from_image_slice</span><span class="p">(</span><span class="n">atom0</span><span class="p">,</span> <span class="n">sublattice</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.intensity_tools.get_sublattice_intensity">
<code class="descclassname">temul.intensity_tools.</code><code class="descname">get_sublattice_intensity</code><span class="sig-paren">(</span><em>sublattice</em>, <em>intensity_type='max'</em>, <em>remove_background_method=None</em>, <em>background_sub=None</em>, <em>num_points=3</em>, <em>percent_to_nn=0.4</em>, <em>mask_radius=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.intensity_tools.get_sublattice_intensity" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the intensity for each atomic column using either max, mean,
min, total or all of them at once.</p>
<p>The intensity values are taken from the area defined by
percent_to_nn.</p>
<p>Results are stored in each Atom_Position object as
amplitude_max_intensity, amplitude_mean_intensity,
amplitude_min_intensity and/or amplitude_total_intensity
which can most easily be accessed through the sublattice object.
See the examples in get_atom_column_amplitude_max_intensity.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sublattice</strong> (<em>sublattice object</em>) – The sublattice whose intensities you are finding.</li>
<li><strong>intensity_type</strong> (<em>string</em><em>, </em><em>default &quot;max&quot;</em>) – Determines the method used to find the sublattice intensities.
The available methods are “max”, “mean”, “min”, “total” and
“all”.</li>
<li><strong>remove_background_method</strong> (<em>string</em><em>, </em><em>default None</em>) – Determines the method used to remove the background_sub
intensities from the image. Options are “average” and “local”.</li>
<li><strong>background_sub</strong> (<em>sublattice object</em><em>, </em><em>default None</em>) – The sublattice used if remove_background_method is used.</li>
<li><strong>num_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 3</em>) – If remove_background_method=”local”, num_points is the number
of nearest neighbour values averaged from background_sub</li>
<li><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.40</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</li>
<li><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Radius of the atomic column in pixels. If chosen, <cite>percent_to_nn</cite> must
be None.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Numpy array, shape depending on <cite>intensity_type</cite></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.intensity_tools</span> <span class="k">import</span> <span class="n">get_sublattice_intensity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_all</span> <span class="o">=</span> <span class="n">get_sublattice_intensity</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">=</span><span class="n">sublattice</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">intensity_type</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">remove_background_method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>Return the summed intensity around the atom:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_total</span> <span class="o">=</span> <span class="n">get_sublattice_intensity</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">=</span><span class="n">sublattice</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">intensity_type</span><span class="o">=</span><span class="s2">&quot;total&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">remove_background_method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>Return the summed intensity around the atom with local background
subtraction:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_total_local</span> <span class="o">=</span> <span class="n">get_sublattice_intensity</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">=</span><span class="n">sublattice</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">intensity_type</span><span class="o">=</span><span class="s2">&quot;total&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">remove_background_method</span><span class="o">=</span><span class="s2">&quot;local&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="n">sublattice</span><span class="p">)</span>
</pre></div>
</div>
<p>Return the maximum intensity around the atom with average background
subtraction:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_max_average</span> <span class="o">=</span> <span class="n">get_sublattice_intensity</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">=</span><span class="n">sublattice</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">intensity_type</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">remove_background_method</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="n">sublattice</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.intensity_tools.remove_average_background">
<code class="descclassname">temul.intensity_tools.</code><code class="descname">remove_average_background</code><span class="sig-paren">(</span><em>sublattice</em>, <em>intensity_type</em>, <em>background_sub</em>, <em>percent_to_nn=0.4</em>, <em>mask_radius=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.intensity_tools.remove_average_background" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the average background from a sublattice intensity using
a background sublattice.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sublattice</strong> (<em>sublattice object</em>) – The sublattice whose intensities are of interest.</li>
<li><strong>intensity_type</strong> (<em>string</em>) – Determines the method used to find the sublattice intensities.
The available methods are “max”, “mean”, “min” and “all”.</li>
<li><strong>background_sub</strong> (<em>sublattice object</em>) – The sublattice used to find the average background.</li>
<li><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.4</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</li>
<li><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Radius of the atomic column in pixels. If chosen, <cite>percent_to_nn</cite> must
be None.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Numpy array, shape depending on <cite>intensity_type</cite></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.intensity_tools</span> <span class="k">import</span> <span class="n">remove_average_background</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># import atomap.dummy_data as dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_all</span> <span class="o">=</span> <span class="n">remove_average_background</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="p">,</span> <span class="n">intensity_type</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="n">sublattice</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_max</span> <span class="o">=</span> <span class="n">remove_average_background</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="p">,</span> <span class="n">intensity_type</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="n">sublattice</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.intensity_tools.remove_local_background">
<code class="descclassname">temul.intensity_tools.</code><code class="descname">remove_local_background</code><span class="sig-paren">(</span><em>sublattice</em>, <em>background_sub</em>, <em>intensity_type</em>, <em>num_points=3</em>, <em>percent_to_nn=0.4</em>, <em>mask_radius=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.intensity_tools.remove_local_background" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the local background from a sublattice intensity using
a background sublattice.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sublattice</strong> (<em>sublattice object</em>) – The sublattice whose intensities are of interest.</li>
<li><strong>intensity_type</strong> (<em>string</em>) – Determines the method used to find the sublattice intensities.
The available methods are “max”, “mean”, “min”, “total” and “all”.</li>
<li><strong>background_sub</strong> (<em>sublattice object</em>) – The sublattice used to find the local backgrounds.</li>
<li><strong>num_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 3</em>) – The number of nearest neighbour values averaged from
background_sub</li>
<li><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.40</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</li>
<li><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Radius of the atomic column in pixels. If chosen, <cite>percent_to_nn</cite> must
be None.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Numpy array, shape depending on <cite>intensity_type</cite></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.intensity_tools</span> <span class="k">import</span> <span class="n">remove_local_background</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_total</span> <span class="o">=</span> <span class="n">remove_local_background</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="p">,</span> <span class="n">intensity_type</span><span class="o">=</span><span class="s2">&quot;total&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="n">sublattice</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_max</span> <span class="o">=</span> <span class="n">remove_local_background</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="p">,</span> <span class="n">intensity_type</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="n">sublattice</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-temul.model_creation">
<span id="model-creation"></span><h3>Model Creation<a class="headerlink" href="#module-temul.model_creation" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="temul.model_creation.assign_z_height">
<code class="descclassname">temul.model_creation.</code><code class="descname">assign_z_height</code><span class="sig-paren">(</span><em>sublattice</em>, <em>lattice_type</em>, <em>material</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.assign_z_height" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.model_creation.assign_z_height_to_sublattice">
<code class="descclassname">temul.model_creation.</code><code class="descname">assign_z_height_to_sublattice</code><span class="sig-paren">(</span><em>sublattice</em>, <em>z_bond_length</em>, <em>material=None</em>, <em>fractional_coordinates=True</em>, <em>atom_layout='bot'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.assign_z_height_to_sublattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the z_heights for each atom position in a sublattice.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – </td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>See example_scripts : Model Creation Example</p>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.auto_generate_sublattice_element_list">
<code class="descclassname">temul.model_creation.</code><code class="descname">auto_generate_sublattice_element_list</code><span class="sig-paren">(</span><em>material_type</em>, <em>elements='Au'</em>, <em>max_number_atoms_z=10</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.auto_generate_sublattice_element_list" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">element_list</span> <span class="o">=</span> <span class="n">auto_generate_sublattice_element_list</span><span class="p">(</span>
<span class="gp">... </span>                    <span class="n">material_type</span><span class="o">=</span><span class="s1">&#39;nanoparticle&#39;</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">elements</span><span class="o">=</span><span class="s1">&#39;Au&#39;</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">max_number_atoms_z</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.change_sublattice_atoms_via_intensity">
<code class="descclassname">temul.model_creation.</code><code class="descname">change_sublattice_atoms_via_intensity</code><span class="sig-paren">(</span><em>sublattice</em>, <em>image_diff_array</em>, <em>darker_or_brighter</em>, <em>element_list</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.change_sublattice_atoms_via_intensity" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the elements in a sublattice object to a higher or lower combined
atomic (Z) number.
The aim is to change the sublattice elements so that the experimental image
agrees with the simulated image in a realistic manner.
See image_difference_intensity()</p>
<p>Get the index in sublattice from the image_difference_intensity() output,
which is the image_diff_array input here.
Then, depending on whether the image_diff_array is for atoms that should
be brighter or darker, set a new element to that sublattice atom_position</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – the elements of this sublattice will be changed</li>
<li><strong>image_diff_array</strong> (<em>Numpy 2D array</em>) – Contains (p, x, y, intensity) where
p = index of Atom_Position in sublattice
x = Atom_Position.pixel_x
y = Atom_Position.pixel_y
intensity = calculated intensity of atom in sublattice.image</li>
<li><strong>darker_or_brighter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – if the element should have a lower combined atomic Z number,
darker_or_brighter = 0.
if the element should have a higher combined atomic Z number,
darker_or_brighter = 1
In other words, the image_diff_array will change the given
sublattice elements to darker or brighter spots by choosing 0 and 1,
respectively.</li>
<li><strong>element_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – list of element configurations</li>
<li><strong>verbose</strong> (<em>Bool</em><em>, </em><em>default False</em>) – If set to True then atom warnings will be printed as output.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_creation</span> <span class="k">import</span> <span class="n">change_sublattice_atoms_via_intensity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># import atomap.dummy_data as dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Mo_1&#39;</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">z_height</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;H_0&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo_2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_diff_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># This will change the 5th atom in the sublattice to a lower atomic Z</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># number, i.e., &#39;H_0&#39; in the given element_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">change_sublattice_atoms_via_intensity</span><span class="p">(</span><span class="n">sublattice</span><span class="o">=</span><span class="n">sublattice</span><span class="p">,</span>
<span class="gp">... </span>                              <span class="n">image_diff_array</span><span class="o">=</span><span class="n">image_diff_array</span><span class="p">,</span>
<span class="gp">... </span>                              <span class="n">darker_or_brighter</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="gp">... </span>                              <span class="n">element_list</span><span class="o">=</span><span class="n">element_list</span><span class="p">)</span>
<span class="go">Changing some atoms</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.change_sublattice_pseudo_inplace">
<code class="descclassname">temul.model_creation.</code><code class="descname">change_sublattice_pseudo_inplace</code><span class="sig-paren">(</span><em>new_atom_positions</em>, <em>old_sublattice</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.change_sublattice_pseudo_inplace" title="Permalink to this definition">¶</a></dt>
<dd><p>Create and return a new Sublattice object which is a copy of
old_sublattice except with extra atom positions set with
new_atom_positions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>new_atom_positions</strong> (<em>NumPy array</em>) – In the form [[x0, y0], [x1, y1], [x2, y2], … ]</li>
<li><strong>old_sublattice</strong> (<em>Atomap Sublattice</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_creation</span> <span class="k">import</span> <span class="n">change_sublattice_pseudo_inplace</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.external.atomap_devel_012.api</span> <span class="k">import</span> <span class="n">Sublattice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_positions</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice_A</span> <span class="o">=</span> <span class="n">Sublattice</span><span class="p">(</span><span class="n">atom_positions</span><span class="p">,</span> <span class="n">image_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_atom_positions</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice_B</span> <span class="o">=</span> <span class="n">change_sublattice_pseudo_inplace</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">new_atom_positions</span><span class="p">,</span> <span class="n">sublattice_A</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice_B</span><span class="o">.</span><span class="n">atom_positions</span>
<span class="go">[[1, 2, 4, 6], [5, 4, 3, 6]]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice_A</span><span class="o">.</span><span class="n">atom_positions</span>
<span class="go">[[1, 2], [5, 4]]</span>
</pre></div>
</div>
<p>It also copies information such as elements</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice_A</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Ti_1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice_A</span> <span class="o">=</span> <span class="n">change_sublattice_pseudo_inplace</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">new_atom_positions</span><span class="p">,</span> <span class="n">sublattice_A</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice_A</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span>
<span class="go">&#39;Ti_1&#39;</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><em>An Atomap Sublattice object that combines the new_atom_positions with</em></li>
<li><em>the information from the old_sublattice.</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.compare_count_atoms_in_sublattice_list">
<code class="descclassname">temul.model_creation.</code><code class="descname">compare_count_atoms_in_sublattice_list</code><span class="sig-paren">(</span><em>counter_list</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.compare_count_atoms_in_sublattice_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare the count of atomap elements in two counter_lists gotten by
count_atoms_in_sublattice_list()</p>
<p>If the counters are the same, then the original atom_lattice is the
same as the refined atom_lattice. It will return the boolean value
True. This can be used to  stop refinement loops if neccessary.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>counter_list</strong> (<em>list of two Counter objects</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><em>Boolean True if the counters are equal,</em></li>
<li><em>boolean False is the counters are not equal.</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_creation</span> <span class="k">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">count_atoms_in_sublattice_list</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">compare_count_atoms_in_sublattice_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_atom_lattice_two_sublattices</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub1</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub2</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub1</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">sub1</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Ti_2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub2</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">sub2</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Cl_1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">added_atoms</span> <span class="o">=</span> <span class="n">count_atoms_in_sublattice_list</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice_list</span><span class="o">=</span><span class="p">[</span><span class="n">sub1</span><span class="p">,</span> <span class="n">sub2</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">filename</span><span class="o">=</span><span class="n">atom_lattice</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">at_lat_before</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_atom_lattice_two_sublattices</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">no_added_atoms</span> <span class="o">=</span> <span class="n">count_atoms_in_sublattice_list</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice_list</span><span class="o">=</span><span class="n">at_lat_before</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">filename</span><span class="o">=</span><span class="n">at_lat_before</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">compare_count_atoms_in_sublattice_list</span><span class="p">([</span><span class="n">added_atoms</span><span class="p">,</span> <span class="n">no_added_atoms</span><span class="p">])</span>
<span class="go">False</span>
</pre></div>
</div>
<p>This function can also be used to stop a refinement loop by using an
if break loop:
# &gt;&gt;&gt; if compare_count_atoms_in_sublattice_list(counter_list) is True:
# &gt;&gt;&gt;    break</p>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.convert_numpy_z_coords_to_z_height_string">
<code class="descclassname">temul.model_creation.</code><code class="descname">convert_numpy_z_coords_to_z_height_string</code><span class="sig-paren">(</span><em>z_coords</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.convert_numpy_z_coords_to_z_height_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert from the output of return_z_coordinates(), which is a 1D numpy
array, to a long string, with which I have set up
sublattice.atom_list[i].z_height.</p>
<p class="rubric">Examples</p>
<p># &gt;&gt;&gt; from temul.model_creation import (
# …     return_z_coordinates,
# …     convert_numpy_z_coords_to_z_height_string)
# &gt;&gt;&gt; Au_NP_z_coord = return_z_coordinates(z_thickness=20,
#       z_bond_length=1.5)
# &gt;&gt;&gt; Au_NP_z_height_string = convert_numpy_z_coords_to_z_height_string(
# …     Au_NP_z_coord)</p>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.correct_background_elements">
<code class="descclassname">temul.model_creation.</code><code class="descname">correct_background_elements</code><span class="sig-paren">(</span><em>sublattice</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.correct_background_elements" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.model_creation.count_all_individual_elements">
<code class="descclassname">temul.model_creation.</code><code class="descname">count_all_individual_elements</code><span class="sig-paren">(</span><em>individual_element_list</em>, <em>dataframe</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.count_all_individual_elements" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform count_element_in_pandas_df() for all elements in a dataframe.
Specify the elements you wish to count in the individual_element_list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>individual_element_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – </li>
<li><strong>dataframe</strong> (<em>pandas dataframe</em>) – The dataframe must have column headers as elements or element
configurations</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict object with each key=individual element and value=element count</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_creation</span> <span class="k">import</span> <span class="n">count_all_individual_elements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Se_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo_1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">counts</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">counts</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">header</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">individual_element_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Mo&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element_count</span> <span class="o">=</span> <span class="n">count_all_individual_elements</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">individual_element_list</span><span class="p">,</span> <span class="n">dataframe</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.count_atoms_in_sublattice_list">
<code class="descclassname">temul.model_creation.</code><code class="descname">count_atoms_in_sublattice_list</code><span class="sig-paren">(</span><em>sublattice_list</em>, <em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.count_atoms_in_sublattice_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Count the elements in a list of Atomap sublattices</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sublattice_list</strong> (<em>list of atomap sublattice</em><em>(</em><em>s</em><em>)</em>) – </li>
<li><strong>filename</strong> (<em>string</em><em>, </em><em>default None</em>) – name with which the image will be saved</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Counter object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_creation</span> <span class="k">import</span> <span class="n">count_atoms_in_sublattice_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># import atomap.dummy_data as dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_atom_lattice_two_sublattices</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub1</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub2</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub1</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">sub1</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Ti_2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub2</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">sub2</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Cl_1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">added_atoms</span> <span class="o">=</span> <span class="n">count_atoms_in_sublattice_list</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice_list</span><span class="o">=</span><span class="p">[</span><span class="n">sub1</span><span class="p">,</span> <span class="n">sub2</span><span class="p">])</span>
</pre></div>
</div>
<p>Compare before and after</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">at_lat_before</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_atom_lattice_two_sublattices</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">no_added_atoms</span> <span class="o">=</span> <span class="n">count_atoms_in_sublattice_list</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">sublattice_list</span><span class="o">=</span><span class="n">at_lat_before</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.count_element_in_pandas_df">
<code class="descclassname">temul.model_creation.</code><code class="descname">count_element_in_pandas_df</code><span class="sig-paren">(</span><em>element</em>, <em>dataframe</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.count_element_in_pandas_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Count the number of a single element in a dataframe</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>element</strong> (<em>string</em>) – element symbol</li>
<li><strong>dataframe</strong> (<em>pandas dataframe</em>) – The dataframe must have column headers as elements or element
configurations</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Counter object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_creation</span> <span class="k">import</span> <span class="n">count_element_in_pandas_df</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Se_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo_1&#39;</span><span class="p">,</span> <span class="s1">&#39;S_2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">counts</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">counts</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">header</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Se_count</span> <span class="o">=</span> <span class="n">count_element_in_pandas_df</span><span class="p">(</span><span class="n">element</span><span class="o">=</span><span class="s1">&#39;Se&#39;</span><span class="p">,</span> <span class="n">dataframe</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Se_count</span>
<span class="go">Counter({0: 9, 1: 8})</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.create_dataframe_for_cif">
<code class="descclassname">temul.model_creation.</code><code class="descname">create_dataframe_for_cif</code><span class="sig-paren">(</span><em>sublattice_list</em>, <em>element_list</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.create_dataframe_for_cif" title="Permalink to this definition">¶</a></dt>
<dd><p>Outputs a dataframe from the inputted sublattice(s), which can then be
input to temul.io.write_cif_from_dataframe().</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sublattice_list</strong> (<em>list of Atomap Sublattice objects</em>) – </li>
<li><strong>element_list</strong> (<em>list of strings</em>) – Each string must be an element symbol from the periodic table.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.find_middle_and_edge_intensities">
<code class="descclassname">temul.model_creation.</code><code class="descname">find_middle_and_edge_intensities</code><span class="sig-paren">(</span><em>sublattice, element_list, standard_element, scaling_exponent, largest_element_intensity=None, split_symbol=['_', '.']</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.find_middle_and_edge_intensities" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a list which represents the peak points of the
intensity distribution for each atom.</p>
<p>works for nanoparticles as well, doesn’t matter what
scaling_exponent you use for nanoparticle. Figure this out!</p>
<p>If the max_element_intensity is set, then the program assumes
that the standard element is the largest available element
combination, and scales the middle and limit intensity lists
so that the middle_intensity_list[-1] == max_element_intensity</p>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.find_middle_and_edge_intensities_for_background">
<code class="descclassname">temul.model_creation.</code><code class="descname">find_middle_and_edge_intensities_for_background</code><span class="sig-paren">(</span><em>elements_from_sub1</em>, <em>elements_from_sub2</em>, <em>sub1_mode</em>, <em>sub2_mode</em>, <em>element_list_sub1</em>, <em>element_list_sub2</em>, <em>middle_intensity_list_sub1</em>, <em>middle_intensity_list_sub2</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.find_middle_and_edge_intensities_for_background" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.model_creation.get_max_number_atoms_z">
<code class="descclassname">temul.model_creation.</code><code class="descname">get_max_number_atoms_z</code><span class="sig-paren">(</span><em>sublattice</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.get_max_number_atoms_z" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.model_creation.get_most_common_sublattice_element">
<code class="descclassname">temul.model_creation.</code><code class="descname">get_most_common_sublattice_element</code><span class="sig-paren">(</span><em>sublattice</em>, <em>info='element'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.get_most_common_sublattice_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the most common element configuration in a sublattice.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Most common element configuration in the sublattice</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_creation</span> <span class="k">import</span> <span class="n">get_most_common_sublattice_element</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># import atomap.dummy_data as dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">atom</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">atom</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Ti_3&#39;</span>
<span class="gp">... </span>        <span class="n">atom</span><span class="o">.</span><span class="n">z_height</span> <span class="o">=</span> <span class="s1">&#39;0.3, 0.6, 0.9&#39;</span>
<span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">atom</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Ti_2&#39;</span>
<span class="gp">... </span>        <span class="n">atom</span><span class="o">.</span><span class="n">z_height</span> <span class="o">=</span> <span class="s1">&#39;0.3, 0.6&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_most_common_sublattice_element</span><span class="p">(</span><span class="n">sublattice</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s1">&#39;element&#39;</span><span class="p">)</span>
<span class="go">&#39;Ti_2&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_most_common_sublattice_element</span><span class="p">(</span><span class="n">sublattice</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s1">&#39;z_height&#39;</span><span class="p">)</span>
<span class="go">&#39;0.3, 0.6&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.get_positions_from_sublattices">
<code class="descclassname">temul.model_creation.</code><code class="descname">get_positions_from_sublattices</code><span class="sig-paren">(</span><em>sublattice_list</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.get_positions_from_sublattices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.model_creation.image_difference_intensity">
<code class="descclassname">temul.model_creation.</code><code class="descname">image_difference_intensity</code><span class="sig-paren">(</span><em>sublattice</em>, <em>sim_image</em>, <em>element_list</em>, <em>filename=None</em>, <em>percent_to_nn=0.4</em>, <em>mask_radius=None</em>, <em>change_sublattice=False</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.image_difference_intensity" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the differences in a sublattice’s atom_position intensities.
Change the elements of these atom_positions depending on this difference of
intensities.</p>
<p>The aim is to change the sublattice elements so that the experimental image
agrees with the simulated image in a realistic manner.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – Elements of this sublattice will be refined</li>
<li><strong>sim_image</strong> (<em>HyperSpy 2D signal</em>) – The image you wish to refine with, usually an image simulation of the
sublattice.image</li>
<li><strong>element_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – list of element configurations, used for refinement</li>
<li><strong>filename</strong> (<em>string</em><em>, </em><em>default None</em>) – name with which the image will be saved</li>
<li><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.40</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</li>
<li><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – Radius of the mask around each atom. If this is not set,
the radius will be the distance to the nearest atom in the
same sublattice times the <cite>percent_to_nn</cite> value.
Note: if <cite>mask_radius</cite> is not specified, the Atom_Position objects
must have a populated nearest_neighbor_list.</li>
<li><strong>change_sublattice</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>default False</em>) – If change_sublattice is set to True, all incorrect element assignments
will be corrected inplace.</li>
<li><strong>verbose</strong> (<em>Bool</em><em>, </em><em>default False</em>) – If set to True then atom warnings will be printed as output.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># import atomap.dummy_data as dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim_image</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_with_vacancies_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Mo_1&#39;</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">z_height</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;H_0&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo_2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_difference_intensity</span><span class="p">(</span><span class="n">sublattice</span><span class="o">=</span><span class="n">sublattice</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">sim_image</span><span class="o">=</span><span class="n">sim_image</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">element_list</span><span class="o">=</span><span class="n">element_list</span><span class="p">)</span>
</pre></div>
</div>
<p>with some image noise and plotting the images</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">image_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim_image</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_with_vacancies_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Mo_1&#39;</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">z_height</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;H_0&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo_2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_difference_intensity</span><span class="p">(</span><span class="n">sublattice</span><span class="o">=</span><span class="n">sublattice</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">sim_image</span><span class="o">=</span><span class="n">sim_image</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">element_list</span><span class="o">=</span><span class="n">element_list</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.image_difference_position">
<code class="descclassname">temul.model_creation.</code><code class="descname">image_difference_position</code><span class="sig-paren">(</span><em>sublattice</em>, <em>sim_image</em>, <em>pixel_threshold</em>, <em>comparison_sublattice_list=None</em>, <em>filename=None</em>, <em>percent_to_nn=0.4</em>, <em>mask_radius=None</em>, <em>num_peaks=5</em>, <em>inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.image_difference_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Find new atomic coordinates by comparing experimental to simulated image.
Changes the sublattice inplace using change_sublattice_pseudo_inplace.</p>
<p>The aim is to change the sublattice elements so that the experimental image
agrees with the simulated image in a realistic manner.
See also image_difference_intensity function and the Model_Refiner class.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sublattice</strong> (<em>Atomap sublattice object</em>) – </li>
<li><strong>sim_image</strong> (<em>simulated image used for comparison with sublattice image</em>) – </li>
<li><strong>pixel_threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – minimum pixel distance from current sublattice atoms. If the new atomic
coordinates are greater than this distance, they will be created.
Choose a pixel_threshold that will not create new atoms in unrealistic
positions.</li>
<li><strong>filename</strong> (<em>string</em><em>, </em><em>default None</em>) – name with which the image will be saved</li>
<li><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.40</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</li>
<li><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – Radius of the mask around each atom. If this is not set,
the radius will be the distance to the nearest atom in the
same sublattice times the <cite>percent_to_nn</cite> value.
Note: if <cite>mask_radius</cite> is not specified, the Atom_Position objects
must have a populated nearest_neighbor_list.</li>
<li><strong>num_peaks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 5</em>) – number of new atoms to add</li>
<li><strong>add_sublattice</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>default False</em>) – If set to True, a new sublattice will be created and returned.
The reason it is set to False is so that one can check if new atoms
would be added with the given parameters.</li>
<li><strong>sublattice_name</strong> (<em>string</em><em>, </em><em>default 'sub_new'</em>) – the outputted sublattice object name and sublattice.name the new
sublattice will be given</li>
<li><strong>inplace</strong> (<em>Bool</em><em>, </em><em>default True</em>) – If set to True, the input <cite>sublattice</cite> will be changed inplace and the
sublattice returned. If set to False, these changes will be output only
to a new sublattice.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li>Atomap Sublattice object if <cite>inplace=False</cite>. See the <cite>inplace</cite> parameter</li>
<li><em>for details.</em></li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_creation</span> <span class="k">import</span> <span class="p">(</span><span class="n">image_difference_position</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">change_sublattice_pseudo_inplace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_with_vacancies_sublattice</span><span class="p">(</span>
<span class="gp">... </span>                                            <span class="n">image_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim_image</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>        <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Mo_1&#39;</span>
<span class="gp">... </span>        <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">z_height</span> <span class="o">=</span> <span class="s1">&#39;0.5&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)</span>
<span class="go">397</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">image_difference_position</span><span class="p">(</span><span class="n">sublattice</span><span class="o">=</span><span class="n">sublattice</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">sim_image</span><span class="o">=</span><span class="n">sim_image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">pixel_threshold</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">percent_to_nn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">mask_radius</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">num_peaks</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">3 new atoms found! Adding new atom positions.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)</span>
<span class="go">400</span>
</pre></div>
</div>
<p>One can now sort these atom positions into elements.</p>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.image_difference_position_new_sub">
<code class="descclassname">temul.model_creation.</code><code class="descname">image_difference_position_new_sub</code><span class="sig-paren">(</span><em>sublattice_list</em>, <em>sim_image</em>, <em>pixel_threshold</em>, <em>filename=None</em>, <em>percent_to_nn=0.4</em>, <em>mask_radius=None</em>, <em>num_peaks=5</em>, <em>add_sublattice=False</em>, <em>sublattice_name='sub_new'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.image_difference_position_new_sub" title="Permalink to this definition">¶</a></dt>
<dd><p>Find new atomic coordinates by comparing experimental to simulated image.
Create a new sublattice to store the new atomic coordinates.</p>
<p>The aim is to change the sublattice elements so that the experimental image
agrees with the simulated image in a realistic manner.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sublattice_list</strong> (<em>list of atomap sublattice objects</em>) – </li>
<li><strong>sim_image</strong> (<em>simulated image used for comparison with sublattice image</em>) – </li>
<li><strong>pixel_threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – minimum pixel distance from current sublattice atoms. If the new atomic
coordinates are greater than this distance, they will be created.
Choose a pixel_threshold that will not create new atoms in unrealistic
positions.</li>
<li><strong>filename</strong> (<em>string</em><em>, </em><em>default None</em>) – name with which the image will be saved</li>
<li><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.40</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</li>
<li><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – Radius of the mask around each atom. If this is not set,
the radius will be the distance to the nearest atom in the
same sublattice times the <cite>percent_to_nn</cite> value.
Note: if <cite>mask_radius</cite> is not specified, the Atom_Position objects
must have a populated nearest_neighbor_list.</li>
<li><strong>num_peaks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 5</em>) – number of new atoms to add</li>
<li><strong>add_sublattice</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>default False</em>) – If set to True, a new sublattice will be created and returned.
The reason it is set to False is so that one can check if new atoms
would be added with the given parameters.</li>
<li><strong>sublattice_name</strong> (<em>string</em><em>, </em><em>default 'sub_new'</em>) – the outputted sublattice object name and sublattice.name the new
sublattice will be given</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Atomap Sublattice object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_creation</span> <span class="k">import</span> <span class="n">image_difference_position</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># import atomap.dummy_data as dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_with_vacancies_sublattice</span><span class="p">(</span>
<span class="gp">... </span>                                            <span class="n">image_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim_image</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>        <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Mo_1&#39;</span>
<span class="gp">... </span>        <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">z_height</span> <span class="o">=</span> <span class="s1">&#39;0.5&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Check without adding a new sublattice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_difference_position_new_sub</span><span class="p">(</span><span class="n">sublattice_list</span><span class="o">=</span><span class="p">[</span><span class="n">sublattice</span><span class="p">],</span>
<span class="gp">... </span>                          <span class="n">sim_image</span><span class="o">=</span><span class="n">sim_image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">pixel_threshold</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">percent_to_nn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">mask_radius</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">num_peaks</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">add_sublattice</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add a new sublattice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># if you have problems with mask_radius, increase it!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Just a gaussian fitting issue, could turn it off!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub_new</span> <span class="o">=</span> <span class="n">image_difference_position_new_sub</span><span class="p">(</span>
<span class="gp">... </span>                                  <span class="n">sublattice_list</span><span class="o">=</span><span class="p">[</span><span class="n">sublattice</span><span class="p">],</span>
<span class="gp">... </span>                                  <span class="n">sim_image</span><span class="o">=</span><span class="n">sim_image</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">pixel_threshold</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">num_peaks</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">add_sublattice</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">New Atoms Found! Adding to a new sublattice</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.print_sublattice_elements">
<code class="descclassname">temul.model_creation.</code><code class="descname">print_sublattice_elements</code><span class="sig-paren">(</span><em>sublattice</em>, <em>number_of_lines='all'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.print_sublattice_elements" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.model_creation.return_xyz_coordinates">
<code class="descclassname">temul.model_creation.</code><code class="descname">return_xyz_coordinates</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>z_thickness</em>, <em>z_bond_length</em>, <em>number_atoms_z=None</em>, <em>fractional_coordinates=True</em>, <em>atom_layout='bot'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.return_xyz_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce xyz coordinates for an xy coordinate given the z-dimension
information.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y</strong> (<em>x</em><em>,</em>) – atom position coordinates.</li>
<li><strong>other parameters see return_z_coordinates</strong><strong>(</strong><strong>)</strong> (<em>for</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">2D numpy array with columns x, y, z</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p># &gt;&gt;&gt; from temul.model_creation import return_xyz_coordinates
# &gt;&gt;&gt; x, y = 2, 3
# &gt;&gt;&gt; atom_coords = return_xyz_coordinates(x, y,
# …                         z_thickness=10,
# …                         z_bond_length=1.5,
# …                         number_atoms_z=5)</p>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.return_z_coordinates">
<code class="descclassname">temul.model_creation.</code><code class="descname">return_z_coordinates</code><span class="sig-paren">(</span><em>z_thickness</em>, <em>z_bond_length</em>, <em>number_atoms_z=None</em>, <em>max_number_atoms_z=None</em>, <em>fractional_coordinates=True</em>, <em>atom_layout='bot'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.return_z_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce fractional z-dimension coordinates for a given thickness and bond
length.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>z_thickness</strong> (<em>number</em>) – Size (Angstrom) of the z-dimension.</li>
<li><strong>z_bond_length</strong> (<em>number</em>) – Size (Angstrom) of the bond length between adjacent atoms in the
z-dimension.</li>
<li><strong>number_atoms_z</strong> (<em>integer</em><em>, </em><em>default None</em>) – number of atoms in the z-dimension. If this is set to an interger
value, it will override the use of z_thickness.</li>
<li><strong>centered_atoms</strong> (<em>Bool</em><em>, </em><em>default True</em>) – If set to True, the z_coordinates will be centered about 0.5.
If set to False, the z_coordinate will start at 0.0.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">1D numpy array</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p># &gt;&gt;&gt; from temul.model_creation import return_z_coordinates
# &gt;&gt;&gt; Au_NP_z_coord = return_z_coordinates(z_thickness=20,
#       z_bond_length=1.5)</p>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.scaling_z_contrast">
<code class="descclassname">temul.model_creation.</code><code class="descname">scaling_z_contrast</code><span class="sig-paren">(</span><em>numerator_sublattice</em>, <em>numerator_element</em>, <em>denominator_sublattice</em>, <em>denominator_element</em>, <em>intensity_type</em>, <em>method</em>, <em>remove_background_method</em>, <em>background_sublattice</em>, <em>num_points</em>, <em>percent_to_nn=0.4</em>, <em>mask_radius=None</em>, <em>split_symbol='_'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.scaling_z_contrast" title="Permalink to this definition">¶</a></dt>
<dd><p>Find new atomic coordinates by comparing experimental to simulated image.
Create a new sublattice to store the new atomic coordinates.</p>
<p>The aim is to change the sublattice elements so that the experimental image
agrees with the simulated image in a realistic manner.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>numerator_sublattice</strong> (<em>Sublattice object</em>) – Sublattice from which the numerator intensity will be calculated
according to Reference [1].</li>
<li><strong>numerator_element</strong> (<em>string</em>) – Element from which the numerator atomic number will be taken
according to Reference [1].</li>
<li><strong>denominator_sublattice</strong> (<em>Sublattice object</em>) – Sublattice from which the denominator intensity will be calculated
according to Reference [1].</li>
<li><strong>denominator_element</strong> (<em>string</em>) – Element from which the denominator atomic number will be taken
according to Reference [1].</li>
<li><strong>intensity_type</strong> (<em>string</em>) – Determines the method used to find the sublattice intensities.
The available methods are “max”, “mean”, “min”, “total” and
“all”.</li>
<li><strong>method</strong> (<em>string</em>) – Method used to calculate the intensity of the sublattices. Options are
“mean” or “mode”.</li>
<li><strong>remove_background_method</strong> (<em>string</em>) – Determines the method used to remove the background_sublattice
intensities from the image. Options are “average” and “local”.</li>
<li><strong>background_sub</strong> (<em>Sublattice object</em>) – The sublattice to be used if remove_background_method is used.</li>
<li><strong>num_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – If remove_background_method=”local”, num_points is the number
of nearest neighbour values averaged from background_sublattice.</li>
<li><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.40</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</li>
<li><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Radius of the atomic column in pixels. If chosen, <cite>percent_to_nn</cite> must
be None.</li>
<li><strong>split_symbol</strong> (<em>string</em><em>, </em><em>default '_'</em>) – The symbols used to split the element into its name
and count.
The first string ‘_’ is used to split the name and count
of the element.
The second string has not been implemented within this function.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><em>Four floats</em></li>
<li><em>scaling_ratio, scaling_exponent, sublattice0_intensity_method,</em></li>
<li><em>sublattice1_intensity_method</em></li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Reference: Krivanek et al. Nature 464, 10.1038/nature08879, (2010)</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_creation</span> <span class="k">import</span> <span class="n">image_difference_position</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_with_vacancies_sublattice</span><span class="p">(</span>
<span class="gp">... </span>                                            <span class="n">image_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim_image</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>        <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Mo_1&#39;</span>
<span class="gp">... </span>        <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">z_height</span> <span class="o">=</span> <span class="s1">&#39;0.5&#39;</span>
</pre></div>
</div>
<p>Check without adding a new sublattice</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image_difference_position_new_sub</span><span class="p">(</span><span class="n">sublattice_list</span><span class="o">=</span><span class="p">[</span><span class="n">sublattice</span><span class="p">],</span>
<span class="gp">... </span>                          <span class="n">sim_image</span><span class="o">=</span><span class="n">sim_image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">pixel_threshold</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">percent_to_nn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">mask_radius</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">num_peaks</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">add_sublattice</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Add a new sublattice</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sub_new</span> <span class="o">=</span> <span class="n">image_difference_position_new_sub</span><span class="p">(</span>
<span class="gp">... </span>                                  <span class="n">sublattice_list</span><span class="o">=</span><span class="p">[</span><span class="n">sublattice</span><span class="p">],</span>
<span class="gp">... </span>                                  <span class="n">sim_image</span><span class="o">=</span><span class="n">sim_image</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">pixel_threshold</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">num_peaks</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">add_sublattice</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">New Atoms Found! Adding to a new sublattice</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.sort_sublattice_intensities">
<code class="descclassname">temul.model_creation.</code><code class="descname">sort_sublattice_intensities</code><span class="sig-paren">(</span><em>sublattice</em>, <em>intensity_type='max'</em>, <em>element_list=[]</em>, <em>scalar_method='mode'</em>, <em>middle_intensity_list=None</em>, <em>limit_intensity_list=None</em>, <em>remove_background_method=None</em>, <em>background_sublattice=None</em>, <em>num_points=3</em>, <em>intensity_list_real=False</em>, <em>percent_to_nn=0.4</em>, <em>mask_radius=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.sort_sublattice_intensities" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="image-simulation-functions">
<h3>Image Simulation Functions<a class="headerlink" href="#image-simulation-functions" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="signal-processing">
<h3>Signal Processing<a class="headerlink" href="#signal-processing" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="module-temul.signal_plotting">
<span id="signal-plotting"></span><h3>Signal Plotting<a class="headerlink" href="#module-temul.signal_plotting" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="temul.signal_plotting.Sublattice_Hover_Intensity">
<em class="property">class </em><code class="descclassname">temul.signal_plotting.</code><code class="descname">Sublattice_Hover_Intensity</code><span class="sig-paren">(</span><em>image</em>, <em>sublattice</em>, <em>sublattice_positions</em>, <em>background_sublattice</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.Sublattice_Hover_Intensity" title="Permalink to this definition">¶</a></dt>
<dd><p>User can hover over sublattice overlaid on STEM image to display the
x,y location and intensity of that point.</p>
<dl class="method">
<dt id="temul.signal_plotting.Sublattice_Hover_Intensity.scaled">
<code class="descname">scaled</code><span class="sig-paren">(</span><em>points</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.Sublattice_Hover_Intensity.scaled" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.signal_plotting.Sublattice_Hover_Intensity.setup_annotation">
<code class="descname">setup_annotation</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.Sublattice_Hover_Intensity.setup_annotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw and hide the annotation box.</p>
</dd></dl>

<dl class="method">
<dt id="temul.signal_plotting.Sublattice_Hover_Intensity.snap">
<code class="descname">snap</code><span class="sig-paren">(</span><em>x</em>, <em>y</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.Sublattice_Hover_Intensity.snap" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value in self.tree closest to x, y.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="temul.signal_plotting.choose_points_on_image">
<code class="descclassname">temul.signal_plotting.</code><code class="descname">choose_points_on_image</code><span class="sig-paren">(</span><em>image</em>, <em>norm='linear'</em>, <em>distance_threshold=4</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.choose_points_on_image" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.signal_plotting.color_palettes">
<code class="descclassname">temul.signal_plotting.</code><code class="descname">color_palettes</code><span class="sig-paren">(</span><em>pallette</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.color_palettes" title="Permalink to this definition">¶</a></dt>
<dd><p>Color sequences that are useful for creating matplotlib colormaps.
Info on “zesty” and other options:
venngage.com/blog/color-blind-friendly-palette/
Info on “r_safe”:
Google: r-plot-color-combinations-that-are-colorblind-accessible</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>palette</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Options are “zesty” (4 colours), and “r_safe” (12 colours).</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list of hex colours</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="temul.signal_plotting.compare_images_line_profile_one_image">
<code class="descclassname">temul.signal_plotting.</code><code class="descname">compare_images_line_profile_one_image</code><span class="sig-paren">(</span><em>image</em>, <em>line_profile_positions</em>, <em>linewidth=1</em>, <em>sampling='Auto'</em>, <em>units='pix'</em>, <em>arrow=None</em>, <em>linetrace=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.compare_images_line_profile_one_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots two line profiles on one image with the line profile intensities
in a subfigure.
See skimage PR PinkShnack for details on implementing profile_line
in skimage: <a class="reference external" href="https://github.com/scikit-image/scikit-image/pull/4206">https://github.com/scikit-image/scikit-image/pull/4206</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>image</strong> (<em>2D Hyperspy signal</em>) – </li>
<li><strong>line_profile_positions</strong> (<em>list of lists</em>) – two line profile coordinates. Use atomap’s am.add_atoms_with_gui()
function to get these. The first two dots will trace the first line
profile etc.
Could be extended to n positions with a basic loop.</li>
<li><strong>linewidth</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 1</em>) – see profile_line for parameter details.</li>
<li><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 'Auto'</em>) – <dl class="docutils">
<dt>if set to ‘Auto’ the function will attempt to find the sampling of</dt>
<dd>image from image.axes_manager[0].scale.</dd>
<dt>arrow <span class="classifier-delimiter">:</span> <span class="classifier">string, default None</span></dt>
<dd>If set, arrows will be plotting on the image. Options are ‘h’ and
‘v’ for horizontal and vertical arrows, respectively.</dd>
</dl>
</li>
<li><strong>linetrace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default None</em>) – If set, the line profile will be plotted on the image.
The thickness of the linetrace will be linewidth*linetrace.
Name could be improved maybe.</li>
<li><strong>kwargs</strong> (<em>Matplotlib keyword arguments passed to imshow</em><em>(</em><em>)</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="temul.signal_plotting.compare_images_line_profile_two_images">
<code class="descclassname">temul.signal_plotting.</code><code class="descname">compare_images_line_profile_two_images</code><span class="sig-paren">(</span><em>imageA</em>, <em>imageB</em>, <em>line_profile_positions</em>, <em>reduce_func=&lt;function mean&gt;</em>, <em>filename=None</em>, <em>linewidth=1</em>, <em>sampling='auto'</em>, <em>units='nm'</em>, <em>crop_offset=20</em>, <em>title='Intensity Profile'</em>, <em>imageA_title='Experiment'</em>, <em>imageB_title='Simulation'</em>, <em>marker_A='v'</em>, <em>marker_B='o'</em>, <em>arrow_markersize=10</em>, <em>figsize=(10</em>, <em>3)</em>, <em>imageB_intensity_offset=0</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.compare_images_line_profile_two_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots two line profiles on two images separately with the line
profile intensities in a subfigure.
See skimage PR PinkShnack for details on implementing profile_line
in skimage: <a class="reference external" href="https://github.com/scikit-image/scikit-image/pull/4206">https://github.com/scikit-image/scikit-image/pull/4206</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>imageB</strong> (<em>imageA</em><em>,</em>) – </li>
<li><strong>line_profile_positions</strong> (<em>list of lists</em>) – one line profile coordinate. Use atomap’s am.add_atoms_with_gui()
function to get these. The two dots will trace the line profile.
See Examples below for example.</li>
<li><strong>filename</strong> (<em>string</em><em>, </em><em>default None</em>) – If this is set to a name (string), the image will be saved with that
name.</li>
<li><strong>reduce_func</strong> (<em>ufunc</em><em>, </em><em>default np.mean</em>) – See skimage’s <cite>profile_line</cite> reduce_func parameter for details.</li>
<li><strong>linewidth</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 1</em>) – see profile_line for parameter details.</li>
<li><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 'auto'</em>) – if set to ‘auto’ the function will attempt to find the sampling of
image from image.axes_manager[0].scale.</li>
<li><strong>units</strong> (<em>string</em><em>, </em><em>default 'nm'</em>) – </li>
<li><strong>crop_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 20</em>) – number of pixels away from the <cite>line_profile_positions</cite> coordinates the
image crop will be taken.</li>
<li><strong>title</strong> (<em>string</em><em>, </em><em>default &quot;Intensity Profile&quot;</em>) – Title of the plot</li>
<li><strong>marker_B</strong> (<em>marker_A</em><em>,</em>) – </li>
<li><strong>arrow_markersize</strong> (<em>Matplotlib markersize</em>) – </li>
<li><strong>figsize</strong> (<em>see Matplotlib for details</em>) – </li>
<li><strong>imageB_intensity_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0</em>) – Adds a y axis offset for comparison purposes.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.signal_plotting</span> <span class="k">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">compare_images_line_profile_two_images</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imageA</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_signal</span><span class="p">(</span><span class="n">image_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imageB</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># line_profile_positions = am.add_atoms_with_gui(imageA)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">line_profile_positions</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">81.58</span><span class="p">,</span> <span class="mf">69.70</span><span class="p">],</span> <span class="p">[</span><span class="mf">193.10</span><span class="p">,</span> <span class="mf">184.08</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">compare_images_line_profile_two_images</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">imageA</span><span class="p">,</span> <span class="n">imageB</span><span class="p">,</span> <span class="n">line_profile_positions</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sampling</span><span class="o">=</span><span class="mf">0.012</span><span class="p">,</span> <span class="n">crop_offset</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
<p>To use the new skimage functionality try the <cite>reduce_func</cite> parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reduce_func</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span> <span class="c1"># can be any ufunc!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">compare_images_line_profile_two_images</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">imageA</span><span class="p">,</span> <span class="n">imageB</span><span class="p">,</span> <span class="n">line_profile_positions</span><span class="p">,</span> <span class="n">reduce_func</span><span class="o">=</span><span class="n">reduce_func</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sampling</span><span class="o">=</span><span class="mf">0.012</span><span class="p">,</span> <span class="n">crop_offset</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">reduce_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">compare_images_line_profile_two_images</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">imageA</span><span class="p">,</span> <span class="n">imageB</span><span class="p">,</span> <span class="n">line_profile_positions</span><span class="p">,</span> <span class="n">reduce_func</span><span class="o">=</span><span class="n">reduce_func</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sampling</span><span class="o">=</span><span class="mf">0.012</span><span class="p">,</span> <span class="n">crop_offset</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
<p>Offseting the y axis of the second image can sometimes be useful:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.example_data</span> <span class="k">as</span> <span class="nn">example_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imageA</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">load_Se_implanted_MoS2_data</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imageA</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">imageA</span><span class="o">.</span><span class="n">data</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">imageA</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imageB</span> <span class="o">=</span> <span class="n">imageA</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">line_profile_positions</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">301.42</span><span class="p">,</span> <span class="mf">318.9</span><span class="p">],</span> <span class="p">[</span><span class="mf">535.92</span><span class="p">,</span> <span class="mf">500.82</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">compare_images_line_profile_two_images</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">imageA</span><span class="p">,</span> <span class="n">imageB</span><span class="p">,</span> <span class="n">line_profile_positions</span><span class="p">,</span> <span class="n">reduce_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">imageB_intensity_offset</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.signal_plotting.expand_palette">
<code class="descclassname">temul.signal_plotting.</code><code class="descname">expand_palette</code><span class="sig-paren">(</span><em>palette</em>, <em>expand_list</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.expand_palette" title="Permalink to this definition">¶</a></dt>
<dd><p>Essentially multiply the palette so that it has the number of instances of
each color that you want.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>palette</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – Color palette in hex, rgb or dec</li>
<li><strong>expand_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – List of integers that will be used to duplicate colours in the palette.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">List of expanded palette</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.signal_plotting</span> <span class="k">as</span> <span class="nn">tmlplot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zest</span> <span class="o">=</span> <span class="n">tmlplot</span><span class="o">.</span><span class="n">color_palettes</span><span class="p">(</span><span class="s1">&#39;zesty&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expanded_palette</span> <span class="o">=</span> <span class="n">tmlplot</span><span class="o">.</span><span class="n">expand_palette</span><span class="p">(</span><span class="n">zest</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.signal_plotting.get_cropping_area">
<code class="descclassname">temul.signal_plotting.</code><code class="descname">get_cropping_area</code><span class="sig-paren">(</span><em>line_profile_positions</em>, <em>crop_offset=20</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.get_cropping_area" title="Permalink to this definition">¶</a></dt>
<dd><p>By inputting the top-left and bottom-right coordinates of a rectangle, this
function will add a border buffer (<cite>crop_offset</cite>) which can be used for
cropping of regions in a plot.
See <cite>compare_images_line_profile_two_images</cite> for use-case</p>
</dd></dl>

<dl class="function">
<dt id="temul.signal_plotting.hex_to_rgb">
<code class="descclassname">temul.signal_plotting.</code><code class="descname">hex_to_rgb</code><span class="sig-paren">(</span><em>hex_values</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.hex_to_rgb" title="Permalink to this definition">¶</a></dt>
<dd><p>Change from hexidecimal color values to rgb color values.
Grabs starting two, middle two, last two values in hex, multiplies by
16^1 and 16^0 for the first and second, respectively.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>hex_values</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – A list of hexidecimal color values as strings e.g., ‘#F5793A’</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list of tuples</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.signal_plotting</span> <span class="k">as</span> <span class="nn">tmlplot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmlplot</span><span class="o">.</span><span class="n">hex_to_rgb</span><span class="p">(</span><span class="n">color_palettes</span><span class="p">(</span><span class="s1">&#39;zesty&#39;</span><span class="p">))</span>
<span class="go">[(245, 121, 58), (169, 90, 161), (133, 192, 249), (15, 32, 128)]</span>
</pre></div>
</div>
<p>Create a matplotlib cmap from a palette with the help of
matplotlib.colors.from_levels_and_colors()</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="k">import</span> <span class="n">from_levels_and_colors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zest</span> <span class="o">=</span> <span class="n">tmlplot</span><span class="o">.</span><span class="n">hex_to_rgb</span><span class="p">(</span><span class="n">tmlplot</span><span class="o">.</span><span class="n">color_palettes</span><span class="p">(</span><span class="s1">&#39;zesty&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zest</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zest</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># make the top and bottom colour the same</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span> <span class="o">=</span> <span class="n">from_levels_and_colors</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="n">tmlplot</span><span class="o">.</span><span class="n">rgb_to_dec</span><span class="p">(</span><span class="n">zest</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.signal_plotting.plot_atom_energies">
<code class="descclassname">temul.signal_plotting.</code><code class="descname">plot_atom_energies</code><span class="sig-paren">(</span><em>sublattice_list</em>, <em>image=None</em>, <em>vac_or_implants=None</em>, <em>elements_dict_other=None</em>, <em>filename='energy_map'</em>, <em>cmap='plasma'</em>, <em>levels=20</em>, <em>colorbar_fontsize=16</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.plot_atom_energies" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to plot the energies of atomic column configurations above 0 as
calculated by DFT.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sublattice_list</strong> (<em>list of Atomap Sublattices</em>) – </li>
<li><strong>image</strong> (<em>array-like</em><em>, </em><em>default None</em>) – The first sublattice image is used if <cite>image=None</cite>.</li>
<li><strong>vac_or_implants</strong> (<em>string</em><em>, </em><em>default None</em>) – <cite>vac_or_implants</cite> options are “implants” and “vac”.</li>
<li><strong>elements_dict_other</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em>, </em><em>default None</em>) – A dictionary of {element_config1: energy1, element_config2: energy2, }
The default is Se antisites in monolayer MoS2.</li>
<li><strong>filename</strong> (<em>string</em><em>, </em><em>default &quot;energy_map&quot;</em>) – Name with which to save the plot.</li>
<li><strong>cmap</strong> (<em>Matplotlib colormap</em><em>, </em><em>default &quot;plasma&quot;</em>) – </li>
<li><strong>levels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 20</em>) – Number of Matplotlib contour map levels.</li>
<li><strong>colorbar_fontsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 16</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><em>The x and y coordinates of the atom positions and the</em></li>
<li><em>atom energy.</em></li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="temul.signal_plotting.rgb_to_dec">
<code class="descclassname">temul.signal_plotting.</code><code class="descname">rgb_to_dec</code><span class="sig-paren">(</span><em>rgb_values</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.rgb_to_dec" title="Permalink to this definition">¶</a></dt>
<dd><p>Change RGB color values to decimal color values (between 0 and 1).
Required for use with matplotlib. See Example in <cite>hex_to_rgb</cite> below.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>rgb_values</strong> (<em>list of tuples</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Decimal color values (RGB but scaled from 0 to 1 rather than 0 to 255)</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-temul.io">
<span id="input-output-io"></span><h3>Input/Output (io)<a class="headerlink" href="#module-temul.io" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="temul.io.batch_convert_emd_to_image">
<code class="descclassname">temul.io.</code><code class="descname">batch_convert_emd_to_image</code><span class="sig-paren">(</span><em>extension_to_save</em>, <em>top_level_directory</em>, <em>glob_search='**/*'</em>, <em>overwrite=True</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.batch_convert_emd_to_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert all .emd files to the chosen extension_to_save file format in the
specified directory and all subdirectories.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>extension_to_save</strong> (<em>string</em>) – the image file extension to be used for saving the image.
See Hyperspy documentation for information on file writing extensions
available: <a class="reference external" href="http://hyperspy.org/hyperspy-doc/current/user_guide/io.html">http://hyperspy.org/hyperspy-doc/current/user_guide/io.html</a></li>
<li><strong>top_level_directory</strong> (<em>string</em>) – The top-level directory in which the emd files exist. The default
glob_search will search this directory and all subdirectories.</li>
<li><strong>glob_search</strong> (string, default “<a href="#id2"><span class="problematic" id="id3">**</span></a>/<a href="#id4"><span class="problematic" id="id5">*</span></a>”) – Glob search string, see glob for more details:
<a class="reference external" href="https://docs.python.org/2/library/glob.html">https://docs.python.org/2/library/glob.html</a>
Default will search this directory and all subdirectories.</li>
<li><strong>overwrite</strong> (<em>Bool</em><em>, </em><em>default True</em>) – Overwrite if the extension_to_save file already exists.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="temul.io.convert_vesta_xyz_to_prismatic_xyz">
<code class="descclassname">temul.io.</code><code class="descname">convert_vesta_xyz_to_prismatic_xyz</code><span class="sig-paren">(</span><em>vesta_xyz_filename, prismatic_xyz_filename, delimiter='   |    |  ', header=None, skiprows=[0, 1], engine='python', occupancy=1.0, rms_thermal_vib=0.05, edge_padding=None, header_comment=&quot;Let's make a file!&quot;, save=True</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.convert_vesta_xyz_to_prismatic_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert from Vesta outputted xyz file format to the prismatic-style xyz
format.
Lose some information from the .cif or .vesta file but okay for now.
Develop your own converter if you need rms and occupancy! Lots to do.</p>
<p>delimiter=’      |       |  ‘ # ase xyz
delimiter=’   |    |  ‘ # vesta xyz</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>vesta_xyz_filename</strong> (<em>string</em>) – name of the vesta outputted xyz file. See vesta &gt; export &gt; xyz</li>
<li><strong>prismatic_xyz_filename</strong> (<em>string</em>) – name to be given to the outputted prismatic xyz file</li>
<li><strong>header</strong><strong>, </strong><strong>skiprows</strong><strong>, </strong><strong>engine</strong> (<em>delimiter</em><em>,</em>) – See pandas.read_csv for documentation
Note that the delimiters here are only available if you use
engine=’python’</li>
<li><strong>rms_thermal_vib</strong> (<em>occupancy</em><em>,</em>) – if you want a file format that will retain these atomic attributes,
use a format other than vesta xyz. Maybe .cif or .vesta keeps these?</li>
<li><strong>header_comment</strong> (<em>string</em>) – header comment for the file.</li>
<li><strong>save</strong> (<em>Bool</em><em>, </em><em>default True</em>) – whether to output the file as a prismatic formatted xyz file with the
name of the file given by “prismatic_xyz_filename”.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">The converted file format as a pandas dataframe</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>See example_data for the vesta xyz file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.io</span> <span class="k">import</span> <span class="n">convert_vesta_xyz_to_prismatic_xyz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prismatic_xyz</span> <span class="o">=</span> <span class="n">convert_vesta_xyz_to_prismatic_xyz</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s1">&#39;temul/example_data/prismatic/example_MoS2_vesta_xyz.xyz&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;temul/example_data/prismatic/MoS2_hex_prismatic.xyz&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;   |    |  &#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">,</span> <span class="n">occupancy</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">rms_thermal_vib</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">header_comment</span><span class="o">=</span><span class="s2">&quot;Let&#39;s do this!&quot;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.io.create_dataframe_for_xyz">
<code class="descclassname">temul.io.</code><code class="descname">create_dataframe_for_xyz</code><span class="sig-paren">(</span><em>sublattice_list</em>, <em>element_list</em>, <em>x_size</em>, <em>y_size</em>, <em>z_size</em>, <em>filename</em>, <em>header_comment='top_level_comment'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.create_dataframe_for_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a Pandas Dataframe and a .xyz file (usable with Prismatic) from the
inputted sublattice(s).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sublattice_list</strong> (<em>list of Atomap Sublattice objects</em>) – </li>
<li><strong>element_list</strong> (<em>list of strings</em>) – Each string must be an element symbol from the periodic table.</li>
<li><strong>y_size</strong><strong>, </strong><strong>z_size</strong> (<em>x_size</em><em>,</em>) – Dimensions of the x,y,z axes in Angstrom.</li>
<li><strong>filename</strong> (<em>string</em>) – Name with which the .xyz file will be saved.</li>
<li><strong>header_comment</strong> (<em>string</em><em>, </em><em>default 'top_level_comment'</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Mo_1&#39;</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">z_height</span> <span class="o">=</span> <span class="s1">&#39;0.5&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Mo_0&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo_2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_size</span><span class="p">,</span> <span class="n">y_size</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z_size</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataframe</span> <span class="o">=</span> <span class="n">create_dataframe_for_xyz</span><span class="p">([</span><span class="n">sublattice</span><span class="p">],</span> <span class="n">element_list</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="n">x_size</span><span class="p">,</span> <span class="n">y_size</span><span class="p">,</span> <span class="n">z_size</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;dataframe&#39;</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="n">header_comment</span><span class="o">=</span><span class="s1">&#39;Here is an Example&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.io.dm3_stack_to_tiff_stack">
<code class="descclassname">temul.io.</code><code class="descname">dm3_stack_to_tiff_stack</code><span class="sig-paren">(</span><em>loading_file</em>, <em>loading_file_extension='.dm3'</em>, <em>saving_file_extension='.tif'</em>, <em>crop=False</em>, <em>crop_start=20.0</em>, <em>crop_end=80.0</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.dm3_stack_to_tiff_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Save an image stack filetype to a different filetype, e.g., dm3 to tiff.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<em>string</em>) – Name of the image stack file</li>
<li><strong>loading_file_extension</strong> (<em>string</em>) – file extension of the filename</li>
<li><strong>saving_file_extension</strong> (<em>string</em>) – file extension you wish to save as</li>
<li><strong>crop</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>default False</em>) – if True, the image will be cropped in the navigation space,
defined by the frames given in crop_start and crop_end</li>
<li><strong>crop_end</strong> (<em>crop_start</em><em>,</em>) – the start and end frame of the crop</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="temul.io.load_data_and_sampling">
<code class="descclassname">temul.io.</code><code class="descname">load_data_and_sampling</code><span class="sig-paren">(</span><em>filename</em>, <em>file_extension=None</em>, <em>invert_image=False</em>, <em>save_image=True</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.load_data_and_sampling" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.io.load_prismatic_mrc_with_hyperspy">
<code class="descclassname">temul.io.</code><code class="descname">load_prismatic_mrc_with_hyperspy</code><span class="sig-paren">(</span><em>prismatic_mrc_filename</em>, <em>save_name='calibrated_data_'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.load_prismatic_mrc_with_hyperspy" title="Permalink to this definition">¶</a></dt>
<dd><p>We are aware this is currently producing errors with new versions of
Prismatic.</p>
<p>Open a prismatic .mrc file and save as a hyperspy object.
Also plots saves a png.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>prismatic_mrc_filename</strong> (<em>string</em>) – name of the outputted prismatic .mrc file.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Hyperspy Signal 2D</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.io</span> <span class="k">import</span> <span class="n">load_prismatic_mrc_with_hyperspy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">load_prismatic_mrc_with_hyperspy</span><span class="p">(</span><span class="s2">&quot;temul/example_data/prismatic/&quot;</span>
<span class="gp">... </span>        <span class="s2">&quot;prism_2Doutput_prismatic_simulation.mrc&quot;</span><span class="p">)</span>
<span class="go">&lt;Signal2D, title: , dimensions: (|1182, 773)&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.io.save_individual_images_from_image_stack">
<code class="descclassname">temul.io.</code><code class="descname">save_individual_images_from_image_stack</code><span class="sig-paren">(</span><em>image_stack</em>, <em>output_folder='individual_images'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.save_individual_images_from_image_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Save each image in an image stack. The images are saved in a new folder.
Useful for after running an image series through Rigid Registration.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>image_stack</strong> (<em>rigid registration image stack object</em>) – </li>
<li><strong>output_folder</strong> (<em>string</em>) – Name of the folder in which all individual images from
the stack will be saved.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="temul.io.write_cif_from_dataframe">
<code class="descclassname">temul.io.</code><code class="descname">write_cif_from_dataframe</code><span class="sig-paren">(</span><em>dataframe</em>, <em>filename</em>, <em>chemical_name_common</em>, <em>cell_length_a</em>, <em>cell_length_b</em>, <em>cell_length_c</em>, <em>cell_angle_alpha=90</em>, <em>cell_angle_beta=90</em>, <em>cell_angle_gamma=90</em>, <em>space_group_name_H_M_alt='P 1'</em>, <em>space_group_IT_number=1</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.write_cif_from_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a cif file from a Pandas Dataframe. This Dataframe can be created
with temul.model_creation.create_dataframe_for_cif().</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dataframe</strong> (<em>dataframe object</em>) – pandas dataframe containing rows of atomic position information</li>
<li><strong>chemical_name_common</strong> (<em>string</em>) – name of chemical</li>
<li><strong>_cell_length_b</strong><strong>, </strong><strong>_cell_length_c</strong> (<em>cell_length_a</em><em>,</em>) – lattice dimensions in angstrom</li>
<li><strong>cell_angle_beta</strong><strong>, </strong><strong>cell_angle_gamma</strong> (<em>cell_angle_alpha</em><em>,</em>) – lattice angles in degrees</li>
<li><strong>space_group_name_H-M_alt</strong> (<em>string</em>) – space group name</li>
<li><strong>space_group_IT_number</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-temul.dummy_data">
<span id="dummy-data"></span><h3>Dummy Data<a class="headerlink" href="#module-temul.dummy_data" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="temul.dummy_data.get_distorted_cubic_signal_adjustable">
<code class="descclassname">temul.dummy_data.</code><code class="descname">get_distorted_cubic_signal_adjustable</code><span class="sig-paren">(</span><em>image_noise=False</em>, <em>y_offset=2</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.get_distorted_cubic_signal_adjustable" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a test image signal of a distorted cubic atomic structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>image_noise</strong> (<em>default False</em>) – If True, will add Gaussian noise to the image.</li>
<li><strong>y_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 2</em>) – The magnitude of distortion of the cubic signal.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">HyperSpy Signal2D</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="k">import</span> <span class="n">get_distorted_cubic_signal_adjustable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">get_distorted_cubic_signal_adjustable</span><span class="p">(</span><span class="n">y_offset</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.dummy_data.get_distorted_cubic_sublattice_adjustable">
<code class="descclassname">temul.dummy_data.</code><code class="descname">get_distorted_cubic_sublattice_adjustable</code><span class="sig-paren">(</span><em>image_noise=False</em>, <em>y_offset=2</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.get_distorted_cubic_sublattice_adjustable" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a test sublattice of a distorted cubic atomic structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>image_noise</strong> (<em>default False</em>) – If True, will add Gaussian noise to the image.</li>
<li><strong>y_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 2</em>) – The magnitude of distortion of the cubic signal.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Atomap Sublattice object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="k">import</span> <span class="n">get_distorted_cubic_sublattice_adjustable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">get_distorted_cubic_sublattice_adjustable</span><span class="p">(</span><span class="n">y_offset</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.dummy_data.get_polarisation_dummy_dataset">
<code class="descclassname">temul.dummy_data.</code><code class="descname">get_polarisation_dummy_dataset</code><span class="sig-paren">(</span><em>image_noise=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.get_polarisation_dummy_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Get an Atom Lattice with two sublattices resembling a perovskite film.</p>
<p>Similar to a perovskite oxide thin film, where the B cations
are shifted in the film.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_noise</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>default False</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>simple_atom_lattice</strong></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Atom_Lattice object</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="k">import</span> <span class="n">get_polarisation_dummy_dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">get_polarisation_dummy_dataset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeB</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">za0</span><span class="p">,</span> <span class="n">za1</span> <span class="o">=</span> <span class="n">sublatticeA</span><span class="o">.</span><span class="n">zones_axis_average_distances</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_p</span> <span class="o">=</span> <span class="n">sublatticeA</span><span class="o">.</span><span class="n">get_polarization_from_second_sublattice</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">za0</span><span class="p">,</span> <span class="n">za1</span><span class="p">,</span> <span class="n">sublatticeB</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_p</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector_list</span> <span class="o">=</span> <span class="n">s_p</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">vector_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vector_list</span><span class="p">],</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vector_list</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vector_list</span><span class="p">],</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vector_list</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
<p>You can they use the plot_polarisation_vectors function to visualise:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="k">import</span> <span class="n">plot_polarisation_vectors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">unit_vector</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plot_style</span><span class="o">=</span><span class="s2">&quot;vector&quot;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">degrees</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.dummy_data.get_simple_cubic_signal">
<code class="descclassname">temul.dummy_data.</code><code class="descname">get_simple_cubic_signal</code><span class="sig-paren">(</span><em>image_noise=False</em>, <em>amplitude=1</em>, <em>with_vacancies=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.get_simple_cubic_signal" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a test image signal of a simple cubic atomic structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>image_noise</strong> (<em>Bool</em><em>, </em><em>default False</em>) – If set to True, will add Gaussian noise to the image.</li>
<li><strong>amplitude</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>list of ints</em><em>, </em><em>default 1</em>) – If amplitude is set to an int, that int will be applied to all atoms in
the sublattice.
If amplitude is set to a list, the atoms will be a distribution set by
np.random.randint between the min and max int.</li>
<li><strong>with_vacancies</strong> (<em>Bool</em><em>, </em><em>default False</em>) – If set to True, the returned signal or sublattice will have some
vacancies.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>signal</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">HyperSpy 2D</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.dummy_data.get_simple_cubic_sublattice">
<code class="descclassname">temul.dummy_data.</code><code class="descname">get_simple_cubic_sublattice</code><span class="sig-paren">(</span><em>image_noise=False</em>, <em>amplitude=1</em>, <em>with_vacancies=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.get_simple_cubic_sublattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a test sublattice of a simple cubic atomic structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>image_noise</strong> (<em>Bool</em><em>, </em><em>default False</em>) – If set to True, will add Gaussian noise to the image.</li>
<li><strong>amplitude</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>list of ints</em><em>, </em><em>default 1</em>) – If amplitude is set to an int, that int will be applied to all atoms in
the sublattice.
If amplitude is set to a list, the atoms will be a distribution set by
np.random.randint between the min and max int.</li>
<li><strong>with_vacancies</strong> (<em>Bool</em><em>, </em><em>default False</em>) – If set to True, the returned signal or sublattice will have some
vacancies.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Atomap Sublattice object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="k">import</span> <span class="n">get_simple_cubic_sublattice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>If you want different atom amplitudes, use <cite>amplitude</cite></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">get_simple_cubic_sublattice</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">amplitude</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
<p>Do not set <cite>amplitude</cite> to two consecutive numbers, as only amplitudes of
the lower number (2 below) will be set, see numpy.random.randint for info.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">get_simple_cubic_sublattice</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">amplitude</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.dummy_data.get_simple_cubic_sublattice_positions_on_vac">
<code class="descclassname">temul.dummy_data.</code><code class="descname">get_simple_cubic_sublattice_positions_on_vac</code><span class="sig-paren">(</span><em>image_noise=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.get_simple_cubic_sublattice_positions_on_vac" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a simple cubic structure similar to <cite>get_simple_cubic_sublattice</cite>
above but the atom positions are also overlaid on the vacancy positions.</p>
</dd></dl>

<dl class="function">
<dt id="temul.dummy_data.polarisation_colorwheel_test_dataset">
<code class="descclassname">temul.dummy_data.</code><code class="descname">polarisation_colorwheel_test_dataset</code><span class="sig-paren">(</span><em>cmap=&lt;matplotlib.colors.LinearSegmentedColormap object&gt;</em>, <em>plot_XY=True</em>, <em>degrees=False</em>, <em>normalise=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.polarisation_colorwheel_test_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Check how the arrows will be plotted on a colorwheel.
Note that for STEM images, the y axis is reversed. This is taken into
account in the plot_polarisation_vectors function, but not here.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_noise</strong> (<em>default False</em>) – If True, will add Gaussian noise to the image.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="k">import</span> <span class="n">polarisation_colorwheel_test_dataset</span>
</pre></div>
</div>
<p>Use a cyclic colormap for better understanding of vectors</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">polarisation_colorwheel_test_dataset</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hsv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>For more cyclic colormap options (and better colormaps), use colorcet</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">colorcet</span> <span class="k">as</span> <span class="nn">cc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">polarisation_colorwheel_test_dataset</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cc</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">colorwheel</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot with degrees rather than the default radians</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">polarisation_colorwheel_test_dataset</span><span class="p">(</span><span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>To just plot the top and bottom arrows as “diverging” the middle of the
colormap should be the same as the edges, such as colorcet’s CET_C4.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">polarisation_colorwheel_test_dataset</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cc</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">CET_C4</span><span class="p">)</span>
</pre></div>
</div>
<p>To just plot the left and right arrows as “diverging” the halfway points of
the colormap should be the same as the edges, such as colorcet’s CET_C4s.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">polarisation_colorwheel_test_dataset</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cc</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">CET_C4s</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.dummy_data.sine_wave_sublattice">
<code class="descclassname">temul.dummy_data.</code><code class="descname">sine_wave_sublattice</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.sine_wave_sublattice" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-temul.example_data">
<span id="example-data"></span><h3>Example Data<a class="headerlink" href="#module-temul.example_data" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="temul.example_data.load_Se_implanted_MoS2_data">
<code class="descclassname">temul.example_data.</code><code class="descname">load_Se_implanted_MoS2_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.example_data.load_Se_implanted_MoS2_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Load an ADF image of Se implanted monolayer MoS2.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.example_data</span> <span class="k">as</span> <span class="nn">example_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">load_Se_implanted_MoS2_data</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.example_data.load_Se_implanted_MoS2_simulation">
<code class="descclassname">temul.example_data.</code><code class="descname">load_Se_implanted_MoS2_simulation</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.example_data.load_Se_implanted_MoS2_simulation" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the simulated image of an MoS2 monolayer</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.example_data</span> <span class="k">as</span> <span class="nn">example_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">load_Se_implanted_MoS2_simulation</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.example_data.load_example_Au_nanoparticle">
<code class="descclassname">temul.example_data.</code><code class="descname">load_example_Au_nanoparticle</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.example_data.load_example_Au_nanoparticle" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the emd STEM image of an example Au nanoparticle</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.example_data</span> <span class="k">as</span> <span class="nn">example_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">load_example_Au_nanoparticle</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.example_data.load_example_Cu_nanoparticle_sim">
<code class="descclassname">temul.example_data.</code><code class="descname">load_example_Cu_nanoparticle_sim</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.example_data.load_example_Cu_nanoparticle_sim" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the hspy simulated image of an example Cu nanoparticle</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.example_data</span> <span class="k">as</span> <span class="nn">example_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">load_example_Cu_nanoparticle_sim</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.example_data.path_to_example_data_MoS2_hex_prismatic">
<code class="descclassname">temul.example_data.</code><code class="descname">path_to_example_data_MoS2_hex_prismatic</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.example_data.path_to_example_data_MoS2_hex_prismatic" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the path of the xyz file for monolayer MoS2</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.example_data</span> <span class="k">as</span> <span class="nn">example_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path_xyz_file</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">path_to_example_data_MoS2_hex_prismatic</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.example_data.path_to_example_data_MoS2_vesta_xyz">
<code class="descclassname">temul.example_data.</code><code class="descname">path_to_example_data_MoS2_vesta_xyz</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.example_data.path_to_example_data_MoS2_vesta_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the path of the vesta xyz file for bilayer MoS2</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.example_data</span> <span class="k">as</span> <span class="nn">example_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path_vesta_file</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">path_to_example_data_MoS2_vesta_xyz</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="dg_visualiser_tutorial.html" class="btn btn-neutral float-left" title="Interactive Image Filtering" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Eoghan O&#39;Connell

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>