

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>API documentation &mdash; TEMUL Toolkit v0.1-alpha documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to TEMUL Toolkit’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> TEMUL Toolkit
          

          
          </a>

          
            
            
              <div class="version">
                Version 0.1-alpha
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">API documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#classes">Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#model-refiner">Model Refiner</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#modules">Modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.polarisation">Polarisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.element_tools">Element Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.intensity_tools">Intensity Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.simulations">Image Simulation Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.signal_processing">Signal Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.signal_plotting">Signal Plotting</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.io">Input/Output (io)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.dummy_data">Dummy Data</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TEMUL Toolkit</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>API documentation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/api_doc.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="api-documentation">
<span id="api-doc"></span><h1>API documentation<a class="headerlink" href="#api-documentation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="model-refiner">
<h3>Model Refiner<a class="headerlink" href="#model-refiner" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="temul.model_refiner.Model_Refiner">
<em class="property">class </em><code class="descclassname">temul.model_refiner.</code><code class="descname">Model_Refiner</code><span class="sig-paren">(</span><em>sublattice_and_elements_dict</em>, <em>comparison_image=None</em>, <em>sampling=None</em>, <em>thickness=10</em>, <em>name=''</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>element_count</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#temul.model_refiner.Model_Refiner.create_simulation" title="temul.model_refiner.Model_Refiner.create_simulation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_simulation</span></code></a>([sublattices,&nbsp;…])</td>
<td>Create and simulate a .xyz file from the sublattice information.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#temul.model_refiner.Model_Refiner.image_difference_intensity_model_refiner" title="temul.model_refiner.Model_Refiner.image_difference_intensity_model_refiner"><code class="xref py py-obj docutils literal notranslate"><span class="pre">image_difference_intensity_model_refiner</span></code></a>([…])</td>
<td>Change the elements for sublattice atom positions that don’t match with comparison_image.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#temul.model_refiner.Model_Refiner.image_difference_position_model_refiner" title="temul.model_refiner.Model_Refiner.image_difference_position_model_refiner"><code class="xref py py-obj docutils literal notranslate"><span class="pre">image_difference_position_model_refiner</span></code></a>([…])</td>
<td>Find new atom positions that were perhaps missed by the initial position finding steps.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#temul.model_refiner.Model_Refiner.set_calibration_area" title="temul.model_refiner.Model_Refiner.set_calibration_area"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_calibration_area</span></code></a>([manual_list])</td>
<td>Area that will be used to calibrate a simulation.</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="85%" />
<col width="15%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>calibrate_comparison_image</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>combine_individual_and_element_counts_as_dataframe</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><strong>compare_latest_element_counts</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>get_element_count_as_dataframe</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><strong>get_individual_elements_as_dataframe</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>plot_element_count_as_bar_chart</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><strong>plot_error_between_comparison_and_reference_image</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>plot_reference_and_comparison_images</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><strong>repeating_intensity_refinement</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>revert_to_previous_refiner_instance</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><strong>set_calibration_separation</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>set_image_xyz_sizes</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><strong>set_thickness</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>update_element_count_and_refinement_history</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><strong>update_element_count_history</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>update_error_between_comparison_and_reference_image</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><strong>update_refinement_history</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>update_sublattices_positions</strong></td>
<td>&#160;</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.calibrate_comparison_image">
<code class="descname">calibrate_comparison_image</code><span class="sig-paren">(</span><em>filename=None</em>, <em>percent_to_nn=None</em>, <em>mask_radius='auto'</em>, <em>refine=True</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.calibrate_comparison_image" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.combine_individual_and_element_counts_as_dataframe">
<code class="descname">combine_individual_and_element_counts_as_dataframe</code><span class="sig-paren">(</span><em>split_symbol=['_', '.']</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.combine_individual_and_element_counts_as_dataframe" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.compare_latest_element_counts">
<code class="descname">compare_latest_element_counts</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.compare_latest_element_counts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.create_simulation">
<code class="descname">create_simulation</code><span class="sig-paren">(</span><em>sublattices='all'</em>, <em>filter_image=False</em>, <em>calibrate_image=True</em>, <em>xyz_sizes=None</em>, <em>header_comment='example'</em>, <em>filename='refiner_simulation'</em>, <em>reference_image='auto'</em>, <em>probeStep=1.0</em>, <em>E0=60000.0</em>, <em>integrationAngleMin=0.085</em>, <em>integrationAngleMax=0.186</em>, <em>detectorAngleStep=0.001</em>, <em>interpolationFactor=16</em>, <em>realspacePixelSize=0.0654</em>, <em>numFP=1</em>, <em>cellDimXYZ=None</em>, <em>tileXYZ=None</em>, <em>probeSemiangle=0.03</em>, <em>alphaBeamMax=0.032</em>, <em>scanWindowMin=0.0</em>, <em>scanWindowMax=1.0</em>, <em>numThreads=2</em>, <em>algorithm='prism'</em>, <em>delta_image_filter=0.5</em>, <em>max_sigma=6</em>, <em>mask_radius='auto'</em>, <em>percent_to_nn=None</em>, <em>refine=True</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.create_simulation" title="Permalink to this definition">¶</a></dt>
<dd><p>Create and simulate a .xyz file from the sublattice information.
Uses the pyprismatic prism algorithm by default.</p>
<p>Note: The error resulting from filter=True with percent_to_nn set can
be fixed by setting mask_radius instead of percent_to_nn.
Error is: “TypeError: ‘NoneType’ object is not iterable”</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>sublattices</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Atomap Sublattices, default ‘all’</span></dt>
<dd><p class="first last">If set to ‘all’, sublattices that exist in the <cite>Model_Refiner</cite> will
all be used. The <cite>sublattice</cite> indexes can be specified in a list.
For example [0, 2] will select the first and third sublattices.
A list of <cite>sublattice</cite> objects can instead be used.</p>
</dd>
<dt><strong>filter_image</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Bool, default False</span></dt>
<dd><p class="first last">Choose whether to filter the simulation with a Gaussian to match
the <cite>reference_image</cite>.</p>
</dd>
<dt><strong>calibrate_image</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Bool, default True</span></dt>
<dd><p class="first last">Choose whether to calibrate the simulation with a set
<cite>calibration_area</cite> and <cite>calibration_separation</cite>.</p>
</dd>
<dt><strong>xyz_sizes</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list, default None</span></dt>
<dd><p class="first last">List of the x, y, z physical size of the reference_image in
angstrom. If None is set, the sizes will be automatically taken
from the <cite>image_xyz_sizes</cite> attribute.</p>
</dd>
<dt><strong>header_comment</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, default ‘example’</span></dt>
<dd><p class="first last">The first line comment for the .xyz file.</p>
</dd>
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, default ‘refiner_simulation’</span></dt>
<dd><p class="first last">filename with which the .xyz file and simulated .mrc file will be
saved.</p>
</dd>
<dt><strong>delta_image_filter</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default 0.5</span></dt>
<dd><p class="first last">The change in sigma for the <cite>filter</cite> Gaussian filter. Small values
will slow the <cite>filter</cite> down.</p>
</dd>
<dt><strong>max_sigma</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default 6</span></dt>
<dd><p class="first last">The maximum sigma used for the <cite>filter</cite> Gaussian filter. Large
values will slow the <cite>filter</cite> down.</p>
</dd>
<dt><strong>percent_to_nn</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default None</span></dt>
<dd><p class="first last">The percentage distance to the nearest neighbour atom used for
atomap atom position refinement.</p>
</dd>
<dt><strong>mask_radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default ‘auto’</span></dt>
<dd><p class="first last">The pixel distance to the nearest neighbour atom used for atomap
atom position refinement</p>
</dd>
<dt><strong>refine</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Bool, default True</span></dt>
<dd><p class="first last">Whether to refine the atom positions for the <cite>calibrate</cite> parameter.</p>
</dd>
<dt><strong>Note: The error resulting from filter=True with percent_to_nn set can</strong></dt>
<dd></dd>
<dt><strong>be fixed by setting mask_radius instead of percent_to_nn.</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>Updates the comparison_image attribute with the newly simulated model.</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="temul.model_refiner.Model_Refiner.element_count">
<code class="descname">element_count</code><a class="headerlink" href="#temul.model_refiner.Model_Refiner.element_count" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.get_element_count_as_dataframe">
<code class="descname">get_element_count_as_dataframe</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.get_element_count_as_dataframe" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.get_individual_elements_as_dataframe">
<code class="descname">get_individual_elements_as_dataframe</code><span class="sig-paren">(</span><em>split_symbol=['_', '.']</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.get_individual_elements_as_dataframe" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.image_difference_intensity_model_refiner">
<code class="descname">image_difference_intensity_model_refiner</code><span class="sig-paren">(</span><em>sublattices='all'</em>, <em>comparison_image='default'</em>, <em>change_sublattice=True</em>, <em>filename=None</em>, <em>verbose=False</em>, <em>refinement_method='Intensity'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.image_difference_intensity_model_refiner" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the elements for sublattice atom positions that don’t match with
comparison_image.</p>
<p>See image_difference_intensity for details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>See image_difference_intensity for parameter information.</strong></dt>
<dd></dd>
<dt><strong>refinement_method</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, default “Intensity”</span></dt>
<dd><p class="first last">Name passed to self.refinement_history for tracking purposes.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="k">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">get_model_refiner_with_12_vacancies_refined</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refiner</span> <span class="o">=</span> <span class="n">get_model_refiner_with_12_vacancies_refined</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">image_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Changing some atoms</span>
<span class="go">Changing some atoms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">history</span> <span class="o">=</span> <span class="n">refiner</span><span class="o">.</span><span class="n">element_count_history_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refiner</span><span class="o">.</span><span class="n">combine_individual_and_element_counts_as_dataframe</span><span class="p">()</span>
<span class="go">                 Ti_0  Ti_1   Ti_2  Ti_3  Ti_4  Ti_5     Ti</span>
<span class="go">0 Initial State   0.0   0.0  400.0   0.0   0.0   0.0  800.0</span>
<span class="go">1 Intensity       0.0  12.0  388.0   0.0   0.0   0.0  788.0</span>
<span class="go">2 Intensity      12.0   0.0  388.0   0.0   0.0   0.0  776.0</span>
<span class="go">3 Intensity      12.0   0.0  388.0   0.0   0.0   0.0  776.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refiner</span><span class="o">.</span><span class="n">plot_element_count_as_bar_chart</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">element_configs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">flip_colrows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refiner</span><span class="o">.</span><span class="n">plot_element_count_as_bar_chart</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">element_configs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">flip_colrows</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refiner</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refiner</span><span class="o">.</span><span class="n">comparison_image</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.image_difference_position_model_refiner">
<code class="descname">image_difference_position_model_refiner</code><span class="sig-paren">(</span><em>sublattices='all'</em>, <em>comparison_sublattice_list='auto'</em>, <em>comparison_image='default'</em>, <em>pixel_threshold=5</em>, <em>num_peaks=5</em>, <em>inplace=True</em>, <em>filename=None</em>, <em>refinement_method='Position'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.image_difference_position_model_refiner" title="Permalink to this definition">¶</a></dt>
<dd><p>Find new atom positions that were perhaps missed by the initial
position finding steps. Each sublattice will be updated with new atom
positions if new atom positions are found.</p>
<p>See image_difference_position for details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>See image_difference_position for parameter information.</strong></dt>
<dd></dd>
<dt><strong>refinement_method</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, default “Position”</span></dt>
<dd><p class="first last">Name passed to self.refinement_history for tracking purposes.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="k">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">get_model_refiner_one_sublattice_3_vacancies</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refiner</span> <span class="o">=</span> <span class="n">get_model_refiner_one_sublattice_3_vacancies</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refiner</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refiner</span><span class="o">.</span><span class="n">comparison_image</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refiner</span><span class="o">.</span><span class="n">image_difference_position_model_refiner</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pixel_threshold</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">3 new atoms found! Adding new atom positions.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refiner</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>Combination of Refinements (cont.)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">refiner</span><span class="o">.</span><span class="n">image_difference_intensity_model_refiner</span><span class="p">()</span>
<span class="go">Changing some atoms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refiner</span><span class="o">.</span><span class="n">image_difference_intensity_model_refiner</span><span class="p">()</span>
<span class="go">Changing some atoms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">history_df</span> <span class="o">=</span> <span class="n">refiner</span><span class="o">.</span><span class="n">get_element_count_as_dataframe</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refiner</span><span class="o">.</span><span class="n">plot_element_count_as_bar_chart</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">element_configs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">flip_colrows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.plot_element_count_as_bar_chart">
<code class="descname">plot_element_count_as_bar_chart</code><span class="sig-paren">(</span><em>element_configs=0, flip_colrows=True, title='Refinement of Elements', fontsize=16, split_symbol=['_', '.']</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.plot_element_count_as_bar_chart" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.plot_error_between_comparison_and_reference_image">
<code class="descname">plot_error_between_comparison_and_reference_image</code><span class="sig-paren">(</span><em>style='plot'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.plot_error_between_comparison_and_reference_image" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.plot_reference_and_comparison_images">
<code class="descname">plot_reference_and_comparison_images</code><span class="sig-paren">(</span><em>title_reference='Reference'</em>, <em>title_comparison='Comparison'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.plot_reference_and_comparison_images" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.repeating_intensity_refinement">
<code class="descname">repeating_intensity_refinement</code><span class="sig-paren">(</span><em>n=5</em>, <em>sublattices='all'</em>, <em>comparison_image='default'</em>, <em>change_sublattice=True</em>, <em>filename=None</em>, <em>verbose=False</em>, <em>ignore_element_count_comparison=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.repeating_intensity_refinement" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.revert_to_previous_refiner_instance">
<code class="descname">revert_to_previous_refiner_instance</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.revert_to_previous_refiner_instance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.set_calibration_area">
<code class="descname">set_calibration_area</code><span class="sig-paren">(</span><em>manual_list=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.set_calibration_area" title="Permalink to this definition">¶</a></dt>
<dd><p>Area that will be used to calibrate a simulation. The pixel separation
can be set with set_calibration_separation. The average intensity of
the atoms chosen by this separation within the area will be set to 1.
The idea is to calibrate the experimental and simulated images with a
known intensity (e.g., single Mo atom in MoS2 is relatively
consistant).</p>
<p>reference_image can be changed via the Model_refiner.reference_image
attribute.</p>
<p>manual_list must be a list of two lists, each of length two.
For example: [ [0,0], [50, 50] ]</p>
</dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.set_calibration_separation">
<code class="descname">set_calibration_separation</code><span class="sig-paren">(</span><em>pixel_separation</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.set_calibration_separation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.set_image_xyz_sizes">
<code class="descname">set_image_xyz_sizes</code><span class="sig-paren">(</span><em>xyz_list</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.set_image_xyz_sizes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.set_thickness">
<code class="descname">set_thickness</code><span class="sig-paren">(</span><em>thickness</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.set_thickness" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.update_element_count_and_refinement_history">
<code class="descname">update_element_count_and_refinement_history</code><span class="sig-paren">(</span><em>refinement_method</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.update_element_count_and_refinement_history" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.update_element_count_history">
<code class="descname">update_element_count_history</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.update_element_count_history" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.update_error_between_comparison_and_reference_image">
<code class="descname">update_error_between_comparison_and_reference_image</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.update_error_between_comparison_and_reference_image" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.update_refinement_history">
<code class="descname">update_refinement_history</code><span class="sig-paren">(</span><em>refinement_method</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.update_refinement_history" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.update_sublattices_positions">
<code class="descname">update_sublattices_positions</code><span class="sig-paren">(</span><em>sublattice_list</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.update_sublattices_positions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="modules">
<h2>Modules<a class="headerlink" href="#modules" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-temul.polarisation">
<span id="polarisation"></span><h3>Polarisation<a class="headerlink" href="#module-temul.polarisation" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="temul.polarisation.atom_deviation_from_straight_line_fit">
<code class="descclassname">temul.polarisation.</code><code class="descname">atom_deviation_from_straight_line_fit</code><span class="sig-paren">(</span><em>sublattice</em>, <em>axis_number: int = 0</em>, <em>save: str = ''</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.atom_deviation_from_straight_line_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>delete atom_planes from a zone axis. Can choose whether to delete
every second, third etc., and the offset from the zero index.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>sublattice</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Atomap Sublattice object</span></dt>
<dd></dd>
<dt><strong>axis_number</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, default 0</span></dt>
<dd><p class="first last">The index of the zone axis (translation symmetry) found by the Atomap
function <cite>construct_zone_axes()</cite>.</p>
</dd>
<dt><strong>save</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, default ‘’</span></dt>
<dd><p class="first last">If set to <cite>save=None</cite>, the array will not be saved.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>Four lists: x, y, u, and v where x,y are the original atom position</strong></dt>
<dd></dd>
<dt><strong>coordinates (simply sublattice.x_position, sublattice.y_position) and</strong></dt>
<dd></dd>
<dt><strong>u,v are the polarisation vector components pointing to the new coordinate.</strong></dt>
<dd></dd>
<dt><strong>These can be input to `plot_polarisation_vectors()` for visualisation.</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="k">import</span> <span class="n">atom_deviation_from_straight_line_fit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_polarization_film_atom_lattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">refine_atom_positions_using_center_of_mass</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">atom_deviation_from_straight_line_fit</span><span class="p">(</span><span class="n">sublatticeA</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>This polarisation can then be visualised in plot_polarisation_vectors()</p>
</dd></dl>

<dl class="function">
<dt id="temul.polarisation.combine_atom_deviations_from_zone_axes">
<code class="descclassname">temul.polarisation.</code><code class="descname">combine_atom_deviations_from_zone_axes</code><span class="sig-paren">(</span><em>sublattice</em>, <em>image=None</em>, <em>axes=None</em>, <em>sampling=None</em>, <em>units='pix'</em>, <em>plot_style='vector'</em>, <em>overlay=True</em>, <em>normalise=False</em>, <em>save='atom_deviation'</em>, <em>title=''</em>, <em>color='yellow'</em>, <em>cmap=None</em>, <em>pivot='middle'</em>, <em>angles='xy'</em>, <em>scale_units='xy'</em>, <em>scale=None</em>, <em>headwidth=3.0</em>, <em>headlength=5.0</em>, <em>headaxislength=4.5</em>, <em>monitor_dpi=96</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.combine_atom_deviations_from_zone_axes" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine the atom deviations of each atom for all zone axes.
Good for plotting vortexes and seeing the total deviation from a
perfect structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>sublattice</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Atomap Sublattice object</span></dt>
<dd></dd>
<dt><strong>For the remaining parameters see `plot_polarisation_vectors()`.</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>Four lists: x, y, u, and v where x,y are the original atom position</strong></dt>
<dd></dd>
<dt><strong>coordinates (simply sublattice.x_position, sublattice.y_position) and</strong></dt>
<dd></dd>
<dt><strong>u,v are the polarisation vector components pointing to the new coordinate.</strong></dt>
<dd></dd>
<dt><strong>These can be input to `plot_polarisation_vectors()` for visualisation.</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="k">import</span> <span class="p">(</span><span class="n">plot_polarisation_vectors</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">combine_atom_deviations_from_zone_axes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_polarization_film_atom_lattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">refine_atom_positions_using_center_of_mass</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">combine_atom_deviations_from_zone_axes</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublatticeA</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
<p># You can also choose the axes:</p>
<p># &gt;&gt;&gt; x,y,u,v = combine_atom_deviations_from_zone_axes(
# …     sublatticeA, axes=[0,3], save=None)
# &gt;&gt;&gt; plot_polarisation_vectors(u, v, x, y, save=None,
# …     image=sublatticeA.image)</p>
</dd></dl>

<dl class="function">
<dt id="temul.polarisation.delete_atom_planes_from_sublattice">
<code class="descclassname">temul.polarisation.</code><code class="descname">delete_atom_planes_from_sublattice</code><span class="sig-paren">(</span><em>sublattice</em>, <em>zone_axis_index=0</em>, <em>atom_plane_tolerance=0.5</em>, <em>divisible_by=3</em>, <em>offset_from_zero=0</em>, <em>opposite=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.delete_atom_planes_from_sublattice" title="Permalink to this definition">¶</a></dt>
<dd><p>delete atom_planes from a zone axis. Can choose whether to delete
every second, third etc., and the offset from the zero index.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>sublattice</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Atomap Sublattice object</span></dt>
<dd></dd>
<dt><strong>zone_axis_index</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, default 0</span></dt>
<dd><p class="first last">The zone axis you wish to specify. You are indexing
sublattice.zones_axis_average_distances[zone_axis_index]</p>
</dd>
<dt><strong>atom_plane_tolerance</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default 0.5</span></dt>
<dd><p class="first last">float between 0.0 and 1.0. Closer to 1 means it will find more zones.
See sublattice.construct_zone_axes() for more information.</p>
</dd>
<dt><strong>divisible_by</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, default 3</span></dt>
<dd><p class="first last">If divisible_by is 2, every second atom_plane is deleted,
If divisible_by is 4, every fourth atom_plane is deleted, etc.</p>
</dd>
<dt><strong>offset_from_zero</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, default 0</span></dt>
<dd><p class="first last">The atom_plane from which you start deleting.
If offset_from_zero is 4, the fourth atom_plane will be
the first deleted.</p>
</dd>
<dt><strong>opposite</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Bool, default False</span></dt>
<dd><p class="first last">If this is set to True, the atom_plane specified by divisible_by
will be kept and all others deleted.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_polarization_film_atom_lattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">delete_atom_planes_from_sublattice</span><span class="p">(</span><span class="n">sublattice</span><span class="o">=</span><span class="n">sublatticeA</span><span class="p">,</span>
<span class="gp">... </span>                       <span class="n">zone_axis_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="n">divisible_by</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="n">offset_from_zero</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">plot_planes</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.polarisation.find_polarisation_vectors">
<code class="descclassname">temul.polarisation.</code><code class="descname">find_polarisation_vectors</code><span class="sig-paren">(</span><em>atom_positions_A</em>, <em>atom_positions_B</em>, <em>save='uv_vectors_array'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.find_polarisation_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the vectors from atom_positions_A to atom_positions_B.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>atom_positions_A, atom_positions_B</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd><p class="first last">Atom positions list in the form [[x1,y1], [x2,y2], [x3,y3]…].</p>
</dd>
<dt><strong>save</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, default ‘uv_vectors_array’</span></dt>
<dd><p class="first last">If set to <cite>save=None</cite>, the array will not be saved.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>two lists: u components and v components.</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="temul.polarisation.get_average_polarisation_in_regions">
<code class="descclassname">temul.polarisation.</code><code class="descname">get_average_polarisation_in_regions</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>u</em>, <em>v</em>, <em>image</em>, <em>divide_into=8</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.get_average_polarisation_in_regions" title="Permalink to this definition">¶</a></dt>
<dd><p>This function splits the image into a certain number of regions and
averages and plots the polarisation vectors in those regions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>x, y</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list or 1D NumPy array</span></dt>
<dd><p class="first last">xy coordinates on the image</p>
</dd>
<dt><strong>u, v</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list or 1D NumPy array</span></dt>
<dd><p class="first last">uv vector components</p>
</dd>
<dt><strong>image</strong> <span class="classifier-delimiter">:</span> <span class="classifier">2D NumPy array</span></dt>
<dd></dd>
<dt><strong>divide_into</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, default 8</span></dt>
<dd><p class="first last">The number used to divide the image up. If 8, then the image will be
split into an 8x8 grid.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>Four lists: x_new, y_new, u_new, v_new.</strong></dt>
<dd></dd>
<dt><strong>x_new and y_new are the certain coordinates of the regions.</strong></dt>
<dd></dd>
<dt><strong>u_new and v_new are the averaged polarisation vectors.</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="k">import</span> <span class="p">(</span>
<span class="gp">... </span>   <span class="n">combine_atom_deviations_from_zone_axes</span><span class="p">,</span>
<span class="gp">... </span>   <span class="n">plot_polarisation_vectors</span><span class="p">,</span> <span class="n">get_average_polarisation_in_regions</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_polarization_film_atom_lattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">refine_atom_positions_using_center_of_mass</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">()</span>
</pre></div>
</div>
<p>Get and plot the original polarisation vectors:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">combine_atom_deviations_from_zone_axes</span><span class="p">(</span><span class="n">sublatticeA</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">normalise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;vector&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Actual Vector Arrows&#39;</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>Get and plot the new, averaged polarisation vectors</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x_new</span><span class="p">,</span> <span class="n">y_new</span><span class="p">,</span> <span class="n">u_new</span><span class="p">,</span> <span class="n">v_new</span> <span class="o">=</span> <span class="n">get_average_polarisation_in_regions</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">divide_into</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x_new</span><span class="p">,</span> <span class="n">y_new</span><span class="p">,</span> <span class="n">u_new</span><span class="p">,</span> <span class="n">v_new</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">normalise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;vector&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Averaged Vector Arrows&#39;</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.polarisation.get_vector_magnitudes">
<code class="descclassname">temul.polarisation.</code><code class="descname">get_vector_magnitudes</code><span class="sig-paren">(</span><em>u</em>, <em>v</em>, <em>sampling=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.get_vector_magnitudes" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the magnitude of a vector given the uv components.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>u,v</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list or 1D NumPy array</span></dt>
<dd></dd>
<dt><strong>sampling</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default None</span></dt>
<dd><p class="first last">If sampling is set, the vector magnitudes (in pix) will be scaled
by sampling (nm/pix).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>1D NumPy array</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="k">import</span> <span class="n">get_vector_magnitudes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># list input</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector_mags</span> <span class="o">=</span> <span class="n">get_vector_magnitudes</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="c1"># np input</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector_mags</span> <span class="o">=</span> <span class="n">get_vector_magnitudes</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sampling</span> <span class="o">=</span> <span class="mf">0.0321</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector_mags</span> <span class="o">=</span> <span class="n">get_vector_magnitudes</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span> <span class="n">sampling</span><span class="o">=</span><span class="n">sampling</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.polarisation.plot_atom_deviation_from_all_zone_axes">
<code class="descclassname">temul.polarisation.</code><code class="descname">plot_atom_deviation_from_all_zone_axes</code><span class="sig-paren">(</span><em>sublattice</em>, <em>image=None</em>, <em>sampling=None</em>, <em>units='pix'</em>, <em>plot_style='vector'</em>, <em>overlay=True</em>, <em>normalise=False</em>, <em>save='atom_deviation'</em>, <em>title=''</em>, <em>color='yellow'</em>, <em>cmap=None</em>, <em>pivot='middle'</em>, <em>angles='xy'</em>, <em>scale_units='xy'</em>, <em>scale=None</em>, <em>headwidth=3.0</em>, <em>headlength=5.0</em>, <em>headaxislength=4.5</em>, <em>monitor_dpi=96</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.plot_atom_deviation_from_all_zone_axes" title="Permalink to this definition">¶</a></dt>
<dd><p># need to add the truncated colormap version: divergent plot.</p>
<p>Plot the atom deviation from a straight line fit for all zone axes
constructed by an Atomap sublattice object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>sublattice</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Atomap Sublattice object</span></dt>
<dd></dd>
<dt><strong>For all other parameters see plot_polarisation_vectors()</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="k">import</span> <span class="n">plot_atom_deviation_from_all_zone_axes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_polarization_film_atom_lattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">refine_atom_positions_using_center_of_mass</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_atom_deviation_from_all_zone_axes</span><span class="p">(</span><span class="n">sublatticeA</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;vector&#39;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.polarisation.plot_polarisation_vectors">
<code class="descclassname">temul.polarisation.</code><code class="descname">plot_polarisation_vectors</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>u</em>, <em>v</em>, <em>image</em>, <em>sampling=None</em>, <em>units='pix'</em>, <em>plot_style='vector'</em>, <em>overlay=True</em>, <em>normalise=False</em>, <em>save='polarisation_image'</em>, <em>title=''</em>, <em>color='yellow'</em>, <em>cmap=None</em>, <em>monitor_dpi=96</em>, <em>pivot='middle'</em>, <em>angles='xy'</em>, <em>scale_units='xy'</em>, <em>scale=None</em>, <em>headwidth=3.0</em>, <em>headlength=5.0</em>, <em>headaxislength=4.5</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.plot_polarisation_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the polarisation vectors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>See matplotlib’s quiver() function for more details.</strong></dt>
<dd></dd>
<dt><strong>x, y</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list or 1D NumPy array</span></dt>
<dd><p class="first last">xy coordinates on the image</p>
</dd>
<dt><strong>u, v</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list or 1D NumPy array</span></dt>
<dd><p class="first last">uv vector components</p>
</dd>
<dt><strong>image</strong> <span class="classifier-delimiter">:</span> <span class="classifier">2D NumPy array</span></dt>
<dd></dd>
<dt><strong>sampling</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default None</span></dt>
<dd><p class="first last">Pixel sampling of the image for calibration.</p>
</dd>
<dt><strong>units</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, default “pix”</span></dt>
<dd><p class="first last">Units used to display the magnitude of the vectors.</p>
</dd>
<dt><strong>plot_style</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, default “vector”</span></dt>
<dd><p class="first last">Options are “vector”, “colormap”, “contour”</p>
</dd>
<dt><strong>overlay</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Bool, default True</span></dt>
<dd><p class="first last">If set to True, the <cite>image</cite> will be plotting behind the arrows</p>
</dd>
<dt><strong>normalise</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Bool, default False</span></dt>
<dd><p class="first last">Normalise the vectors to unit vectors for plotting purposes.
Magnitude will still be displayed correctly.</p>
</dd>
<dt><strong>save</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, default “polarisation_image”</span></dt>
<dd><p class="first last">If set to <cite>save=None</cite>, the array will not be saved.</p>
</dd>
<dt><strong>title</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, default “”</span></dt>
<dd><p class="first last">Title of the plot.</p>
</dd>
<dt><strong>color</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, default “r”</span></dt>
<dd><p class="first last">Color of the arrows when <a href="#id1"><span class="problematic" id="id2">`</span></a>plot_style=”vector” or “contour”.</p>
</dd>
<dt><strong>cmap</strong> <span class="classifier-delimiter">:</span> <span class="classifier">matplotlib colormap, default “viridis”</span></dt>
<dd></dd>
<dt><strong>monitor_dpi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, default 96</span></dt>
<dd><p class="first last">The DPI of the monitor, generally 96 pixels. Used to scale the image
so that large images render correctly. Use a smaller value or
<cite>monitor_dpi=None</cite> to enlarge too-small images.</p>
</dd>
<dt><strong>See matplotlib’s quiver function for the remaining parameters.</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="k">import</span> <span class="p">(</span>
<span class="gp">... </span>   <span class="n">combine_atom_deviations_from_zone_axes</span><span class="p">,</span>
<span class="gp">... </span>   <span class="n">plot_polarisation_vectors</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_polarization_film_atom_lattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">refine_atom_positions_using_center_of_mass</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">combine_atom_deviations_from_zone_axes</span><span class="p">(</span><span class="n">sublatticeA</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>vector plot with red arrows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">normalise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;vector&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Vector Arrows&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>vector plot with red arrows overlaid on the image:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">normalise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;vector&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>vector plot with colormap viridis:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">normalise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;colormap&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>colormap arrows with sampling applied:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">sampling</span><span class="o">=</span><span class="mf">3.0321</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;pm&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">normalise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;colormap&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>vector plot with colormap viridis and unit vectors:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">normalise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;colormap&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>normalised vectors on a contourf map:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">normalise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;contour&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pivot</span><span class="o">=</span><span class="s1">&#39;middle&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.polarisation.truncate_colormap">
<code class="descclassname">temul.polarisation.</code><code class="descname">truncate_colormap</code><span class="sig-paren">(</span><em>cmap</em>, <em>minval=0.0</em>, <em>maxval=1.0</em>, <em>n=100</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.truncate_colormap" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-temul.element_tools">
<span id="element-tools"></span><h3>Element Tools<a class="headerlink" href="#module-temul.element_tools" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="temul.element_tools.atomic_radii_in_pixels">
<code class="descclassname">temul.element_tools.</code><code class="descname">atomic_radii_in_pixels</code><span class="sig-paren">(</span><em>sampling</em>, <em>element_symbol</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.element_tools.atomic_radii_in_pixels" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the atomic radius of an element in pixels, scaled by an image sampling</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>sampling</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default None</span></dt>
<dd><p class="first last">sampling of an image in units of nm/pix</p>
</dd>
<dt><strong>element_symbol</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, default None</span></dt>
<dd><p class="first last">Symbol of an element from the periodic table of elements</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>Half the colavent radius of the input element in pixels</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.element_tools</span> <span class="k">import</span> <span class="n">atomic_radii_in_pixels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># pretend it is a 5x5 nm image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_sampling</span> <span class="o">=</span> <span class="mi">5</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="c1"># units nm/pix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radius_pix_Mo</span> <span class="o">=</span> <span class="n">atomic_radii_in_pixels</span><span class="p">(</span><span class="n">image_sampling</span><span class="p">,</span> <span class="s1">&#39;Mo&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radius_pix_S</span> <span class="o">=</span> <span class="n">atomic_radii_in_pixels</span><span class="p">(</span><span class="n">image_sampling</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.element_tools.combine_element_lists">
<code class="descclassname">temul.element_tools.</code><code class="descname">combine_element_lists</code><span class="sig-paren">(</span><em>lists</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.element_tools.combine_element_lists" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.element_tools.get_and_return_element">
<code class="descclassname">temul.element_tools.</code><code class="descname">get_and_return_element</code><span class="sig-paren">(</span><em>element_symbol</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.element_tools.get_and_return_element" title="Permalink to this definition">¶</a></dt>
<dd><p>From the elemental symbol, e.g., ‘H’ for Hydrogen, returns Hydrogen as
a periodictable.core.Element object for further use.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>element_symbol</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, default None</span></dt>
<dd><p class="first last">Symbol of an element from the periodic table of elements</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>A periodictable.core.Element object</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.element_tools</span> <span class="k">import</span> <span class="n">get_and_return_element</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Moly</span> <span class="o">=</span> <span class="n">get_and_return_element</span><span class="p">(</span><span class="n">element_symbol</span><span class="o">=</span><span class="s1">&#39;Mo&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#print(Moly.covalent_radius)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#print(Moly.symbol)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#print(Moly.number)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.element_tools.get_individual_elements_from_element_list">
<code class="descclassname">temul.element_tools.</code><code class="descname">get_individual_elements_from_element_list</code><span class="sig-paren">(</span><em>element_list, split_symbol=['_', '.']</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.element_tools.get_individual_elements_from_element_list" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Examples</p>
<p>Single list</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.element_tools</span> <span class="k">as</span> <span class="nn">tml_el</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Mo_0&#39;</span><span class="p">,</span> <span class="s1">&#39;Ti_3&#39;</span><span class="p">,</span> <span class="s1">&#39;Ti_9&#39;</span><span class="p">,</span> <span class="s1">&#39;Ge_2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_individual_elements_from_element_list</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">element_list</span><span class="p">,</span> <span class="n">split_symbol</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">])</span>
<span class="go">[&#39;Ge&#39;, &#39;Mo&#39;, &#39;Ti&#39;]</span>
</pre></div>
</div>
<p>some complex atomic_columns</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">element_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Mo_0&#39;</span><span class="p">,</span> <span class="s1">&#39;Ti_3.Re_7&#39;</span><span class="p">,</span> <span class="s1">&#39;Ti_9.Re_3&#39;</span><span class="p">,</span> <span class="s1">&#39;Ge_2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_individual_elements_from_element_list</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">element_list</span><span class="p">,</span> <span class="n">split_symbol</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">])</span>
<span class="go">[&#39;Ge&#39;, &#39;Mo&#39;, &#39;Re&#39;, &#39;Ti&#39;]</span>
</pre></div>
</div>
<p>multiple lists in element_list. Used in Model_Refiner if you have more than
one sublattice.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">element_list</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;Ti_7_0&#39;</span><span class="p">,</span> <span class="s1">&#39;Ti_9.Re_3&#39;</span><span class="p">,</span> <span class="s1">&#39;Ge_2&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;B_9&#39;</span><span class="p">,</span> <span class="s1">&#39;B_2.Fe_8&#39;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_individual_elements_from_element_list</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">element_list</span><span class="p">,</span> <span class="n">split_symbol</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">])</span>
<span class="go">[&#39;B&#39;, &#39;Fe&#39;, &#39;Ge&#39;, &#39;Re&#39;, &#39;Ti&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.element_tools.split_and_sort_element">
<code class="descclassname">temul.element_tools.</code><code class="descname">split_and_sort_element</code><span class="sig-paren">(</span><em>element, split_symbol=['_', '.']</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.element_tools.split_and_sort_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts info from input atomic column element configuration
Split an element and its count, then sort the element for
use with other functions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>element</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, default None</span></dt>
<dd><p class="first last">element species and count must be separated by the
first string in the split_symbol list.
separate elements must be separated by the second
string in the split_symbol list.</p>
</dd>
<dt><strong>split_symbol</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of strings, default [‘_’, ‘.’]</span></dt>
<dd><p class="first last">The symbols used to split the element into its name
and count.
The first string ‘_’ is used to split the name and count
of the element.
The second string is used to split different elements in
an atomic column configuration.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>list of a list with element_split, element_name, element_count, and</strong></dt>
<dd></dd>
<dt><strong>element_atomic_number.</strong></dt>
<dd></dd>
<dt><strong>See examples below</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.element_tools</span> <span class="k">import</span> <span class="n">split_and_sort_element</span>
</pre></div>
</div>
<p>simple atomic column</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">split_and_sort_element</span><span class="p">(</span><span class="n">element</span><span class="o">=</span><span class="s1">&#39;S_1&#39;</span><span class="p">)</span>
<span class="go">[[[&#39;S&#39;, &#39;1&#39;], &#39;S&#39;, 1, 16]]</span>
</pre></div>
</div>
<p>complex atomic column</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">info</span> <span class="o">=</span> <span class="n">split_and_sort_element</span><span class="p">(</span><span class="n">element</span><span class="o">=</span><span class="s1">&#39;O_6.Mo_3.Ti_5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-temul.intensity_tools">
<span id="intensity-tools"></span><h3>Intensity Tools<a class="headerlink" href="#module-temul.intensity_tools" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="temul.intensity_tools.get_pixel_count_from_image_slice">
<code class="descclassname">temul.intensity_tools.</code><code class="descname">get_pixel_count_from_image_slice</code><span class="sig-paren">(</span><em>self</em>, <em>image_data</em>, <em>percent_to_nn=0.4</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.intensity_tools.get_pixel_count_from_image_slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Fid the number of pixels in an area when calling
_get_image_slice_around_atom()</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>image_data</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Numpy 2D array</span></dt>
<dd></dd>
<dt><strong>percent_to_nn</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default 0.40</span></dt>
<dd><p class="first last">Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>The number of pixels in the image_slice</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.intensity_tools</span> <span class="k">import</span> <span class="n">get_pixel_count_from_image_slice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom0</span> <span class="o">=</span> <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pixel_count</span> <span class="o">=</span> <span class="n">get_pixel_count_from_image_slice</span><span class="p">(</span><span class="n">atom0</span><span class="p">,</span> <span class="n">sublattice</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.intensity_tools.get_sublattice_intensity">
<code class="descclassname">temul.intensity_tools.</code><code class="descname">get_sublattice_intensity</code><span class="sig-paren">(</span><em>sublattice</em>, <em>intensity_type='max'</em>, <em>remove_background_method=None</em>, <em>background_sub=None</em>, <em>num_points=3</em>, <em>percent_to_nn=0.4</em>, <em>mask_radius=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.intensity_tools.get_sublattice_intensity" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the intensity for each atomic column using either max, mean,
min, total or all of them at once.</p>
<p>The intensity values are taken from the area defined by
percent_to_nn.</p>
<p>Results are stored in each Atom_Position object as
amplitude_max_intensity, amplitude_mean_intensity,
amplitude_min_intensity and/or amplitude_total_intensity
which can most easily be accessed through the sublattice object.
See the examples in get_atom_column_amplitude_max_intensity.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>sublattice</strong> <span class="classifier-delimiter">:</span> <span class="classifier">sublattice object</span></dt>
<dd><p class="first last">The sublattice whose intensities you are finding.</p>
</dd>
<dt><strong>intensity_type</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, default ‘max’</span></dt>
<dd><p class="first last">Determines the method used to find the sublattice intensities.
The available methods are ‘max’, ‘mean’, ‘min’, ‘total’ and
‘all’.</p>
</dd>
<dt><strong>remove_background_method</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, default None</span></dt>
<dd><p class="first last">Determines the method used to remove the background_sub
intensities from the image. Options are ‘average’ and ‘local’.</p>
</dd>
<dt><strong>background_sub</strong> <span class="classifier-delimiter">:</span> <span class="classifier">sublattice object, default None</span></dt>
<dd><p class="first last">The sublattice used if remove_background_method is used.</p>
</dd>
<dt><strong>num_points</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, default 3</span></dt>
<dd><p class="first last">If remove_background_method=’local’, num_points is the number
of nearest neighbour values averaged from background_sub</p>
</dd>
<dt><strong>percent_to_nn</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default 0.40</span></dt>
<dd><p class="first last">Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>2D numpy array</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.intensity_tools</span> <span class="k">import</span> <span class="n">get_sublattice_intensity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_all</span> <span class="o">=</span> <span class="n">get_sublattice_intensity</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">=</span><span class="n">sublattice</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">intensity_type</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">remove_background_method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_total</span> <span class="o">=</span> <span class="n">get_sublattice_intensity</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">=</span><span class="n">sublattice</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">intensity_type</span><span class="o">=</span><span class="s1">&#39;total&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">remove_background_method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_total_local</span> <span class="o">=</span> <span class="n">get_sublattice_intensity</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">=</span><span class="n">sublattice</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">intensity_type</span><span class="o">=</span><span class="s1">&#39;total&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">remove_background_method</span><span class="o">=</span><span class="s1">&#39;local&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="n">sublattice</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_max_average</span> <span class="o">=</span> <span class="n">get_sublattice_intensity</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">=</span><span class="n">sublattice</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">intensity_type</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">remove_background_method</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="n">sublattice</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.intensity_tools.remove_average_background">
<code class="descclassname">temul.intensity_tools.</code><code class="descname">remove_average_background</code><span class="sig-paren">(</span><em>sublattice</em>, <em>intensity_type</em>, <em>background_sub</em>, <em>percent_to_nn=0.4</em>, <em>mask_radius=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.intensity_tools.remove_average_background" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the average background from a sublattice intensity using
a background sublattice.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>sublattice</strong> <span class="classifier-delimiter">:</span> <span class="classifier">sublattice object</span></dt>
<dd><p class="first last">The sublattice whose intensities are of interest.</p>
</dd>
<dt><strong>intensity_type</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">Determines the method used to find the sublattice intensities.
The available methods are ‘max’, ‘mean’, ‘min’ and ‘all’.</p>
</dd>
<dt><strong>background_sub</strong> <span class="classifier-delimiter">:</span> <span class="classifier">sublattice object</span></dt>
<dd><p class="first last">The sublattice used to find the average background.</p>
</dd>
<dt><strong>percent_to_nn</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default 0.4</span></dt>
<dd><p class="first last">Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>2D numpy array</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.intensity_tools</span> <span class="k">import</span> <span class="n">remove_average_background</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_all</span> <span class="o">=</span> <span class="n">remove_average_background</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="p">,</span> <span class="n">intensity_type</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="n">sublattice</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_max</span> <span class="o">=</span> <span class="n">remove_average_background</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="p">,</span> <span class="n">intensity_type</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="n">sublattice</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.intensity_tools.remove_local_background">
<code class="descclassname">temul.intensity_tools.</code><code class="descname">remove_local_background</code><span class="sig-paren">(</span><em>sublattice</em>, <em>background_sub</em>, <em>intensity_type</em>, <em>num_points=3</em>, <em>percent_to_nn=0.4</em>, <em>mask_radius=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.intensity_tools.remove_local_background" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the local background from a sublattice intensity using
a background sublattice.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>sublattice</strong> <span class="classifier-delimiter">:</span> <span class="classifier">sublattice object</span></dt>
<dd><p class="first last">The sublattice whose intensities are of interest.</p>
</dd>
<dt><strong>intensity_type</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">Determines the method used to find the sublattice intensities.
The available methods are ‘max’, ‘mean’, ‘min’, ‘total’ and ‘all’.</p>
</dd>
<dt><strong>background_sub</strong> <span class="classifier-delimiter">:</span> <span class="classifier">sublattice object</span></dt>
<dd><p class="first last">The sublattice used to find the local backgrounds.</p>
</dd>
<dt><strong>num_points</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, default 3</span></dt>
<dd><p class="first last">The number of nearest neighbour values averaged from
background_sub</p>
</dd>
<dt><strong>percent_to_nn</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default 0.40</span></dt>
<dd><p class="first last">Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>2D numpy array</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.intensity_tools</span> <span class="k">import</span> <span class="n">remove_local_background</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_total</span> <span class="o">=</span> <span class="n">remove_local_background</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="p">,</span> <span class="n">intensity_type</span><span class="o">=</span><span class="s1">&#39;total&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="n">sublattice</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_max</span> <span class="o">=</span> <span class="n">remove_local_background</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="p">,</span> <span class="n">intensity_type</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="n">sublattice</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-temul.simulations">
<span id="image-simulation-functions"></span><h3>Image Simulation Functions<a class="headerlink" href="#module-temul.simulations" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="temul.simulations.image_refine_via_intensity_loop">
<code class="descclassname">temul.simulations.</code><code class="descname">image_refine_via_intensity_loop</code><span class="sig-paren">(</span><em>atom_lattice</em>, <em>change_sublattice</em>, <em>calibration_separation</em>, <em>calibration_area</em>, <em>percent_to_nn</em>, <em>mask_radius</em>, <em>element_list</em>, <em>image_sampling</em>, <em>iterations</em>, <em>delta_image_filter</em>, <em>image_size_x_nm</em>, <em>image_size_y_nm</em>, <em>image_size_z_nm</em>, <em>simulation_filename</em>, <em>filename</em>, <em>intensity_type</em>, <em>intensity_refine_name='intensity_refine_'</em>, <em>folder_name='refinement_of_intensity'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.simulations.image_refine_via_intensity_loop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.simulations.image_refine_via_position_loop">
<code class="descclassname">temul.simulations.</code><code class="descname">image_refine_via_position_loop</code><span class="sig-paren">(</span><em>image</em>, <em>sublattice_list</em>, <em>filename</em>, <em>xyz_filename</em>, <em>add_sublattice</em>, <em>pixel_threshold</em>, <em>num_peaks</em>, <em>image_size_x_nm</em>, <em>image_size_y_nm</em>, <em>image_size_z_nm</em>, <em>calibration_area</em>, <em>calibration_separation</em>, <em>element_list</em>, <em>element_list_new_sub</em>, <em>middle_intensity_list</em>, <em>limit_intensity_list</em>, <em>delta_image_filter=0.5</em>, <em>intensity_type='max'</em>, <em>scalar_method='mode'</em>, <em>remove_background_method=None</em>, <em>background_sublattice=None</em>, <em>num_points=3</em>, <em>percent_to_nn=0.4</em>, <em>mask_radius=None</em>, <em>iterations=10</em>, <em>max_sigma=10</em>, <em>E0=60000.0</em>, <em>integrationAngleMin=0.085</em>, <em>integrationAngleMax=0.186</em>, <em>interpolationFactor=16</em>, <em>realspacePixelSize=0.0654</em>, <em>numFP=1</em>, <em>probeSemiangle=0.03</em>, <em>alphaBeamMax=0.032</em>, <em>scanWindowMin=0.0</em>, <em>scanWindowMax=1.0</em>, <em>algorithm='prism'</em>, <em>numThreads=2</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.simulations.image_refine_via_position_loop" title="Permalink to this definition">¶</a></dt>
<dd><p>Image Position Loop</p>
</dd></dl>

<dl class="function">
<dt id="temul.simulations.load_prismatic_mrc_with_hyperspy">
<code class="descclassname">temul.simulations.</code><code class="descname">load_prismatic_mrc_with_hyperspy</code><span class="sig-paren">(</span><em>prismatic_mrc_filename</em>, <em>save_name='calibrated_data_'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.simulations.load_prismatic_mrc_with_hyperspy" title="Permalink to this definition">¶</a></dt>
<dd><p>Open a prismatic .mrc file and save as a hyperspy object.
Also plots save saves a png.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>prismatic_mrc_filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">name of the outputted prismatic .mrc file.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>Hyperspy Signal 2D of the simulation</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.simulations</span> <span class="k">import</span> <span class="n">load_prismatic_mrc_with_hyperspy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">load_prismatic_mrc_with_hyperspy</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">prismatic_mrc_filename</span><span class="o">=</span><span class="s2">&quot;example_data/prismatic/&quot;</span>
<span class="gp">... </span>        <span class="s2">&quot;prism_2Doutput_prismatic_simulation.mrc&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">save_name</span><span class="o">=</span><span class="s1">&#39;calibrated_data_&#39;</span><span class="p">)</span>
<span class="go">&lt;Signal2D, title: , dimensions: (|1182, 773)&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.simulations.simulate_and_calibrate_with_prismatic">
<code class="descclassname">temul.simulations.</code><code class="descname">simulate_and_calibrate_with_prismatic</code><span class="sig-paren">(</span><em>xyz_filename</em>, <em>filename</em>, <em>reference_image</em>, <em>calibration_area</em>, <em>calibration_separation</em>, <em>percent_to_nn=0.4</em>, <em>mask_radius=None</em>, <em>refine=True</em>, <em>scalebar_true=False</em>, <em>probeStep=None</em>, <em>E0=60000.0</em>, <em>integrationAngleMin=0.085</em>, <em>integrationAngleMax=0.186</em>, <em>interpolationFactor=16</em>, <em>realspacePixelSize=0.0654</em>, <em>numFP=1</em>, <em>probeSemiangle=0.03</em>, <em>alphaBeamMax=0.032</em>, <em>scanWindowMin=0.0</em>, <em>scanWindowMax=1.0</em>, <em>algorithm='prism'</em>, <em>numThreads=2</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.simulations.simulate_and_calibrate_with_prismatic" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate an xyz coordinate model with pyprismatic
fast simulation software.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>xyz_filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">filename of the xyz coordinate model. Must be in the prismatic format.
See <a class="reference external" href="http://prism-em.com/docs-inputs/">http://prism-em.com/docs-inputs/</a> for more information.</p>
</dd>
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, default None</span></dt>
<dd><p class="first last">name with which the image will be saved</p>
</dd>
<dt><strong>reference_image</strong> <span class="classifier-delimiter">:</span> <span class="classifier">hyperspy signal 2D</span></dt>
<dd><p class="first last">image from which calibration information is taken, such
as sampling, pixel height and pixel width</p>
</dd>
<dt><strong>calibration_area</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd><p class="first last">xy pixel coordinates of the image area to be used to calibrate
the intensity. In the form [[0,0], [512,512]]
See calibrate_intensity_distance_with_sublattice_roi()</p>
</dd>
<dt><strong>calibration_separation</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">pixel separation used for the intensity calibration.
See calibrate_intensity_distance_with_sublattice_roi()</p>
</dd>
<dt><strong>percent_to_nn</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default 0.40</span></dt>
<dd><p class="first last">Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</p>
</dd>
<dt><strong>mask_radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default None</span></dt>
<dd><p class="first last">Radius of the mask around each atom. If this is not set,
the radius will be the distance to the nearest atom in the
same sublattice times the <cite>percent_to_nn</cite> value.
Note: if <cite>mask_radius</cite> is not specified, the Atom_Position objects
must have a populated nearest_neighbor_list.</p>
</dd>
<dt><strong>refine, scalebar_true</strong></dt>
<dd><p class="first last">See function calibrate_intensity_distance_with_sublattice_roi()</p>
</dd>
<dt><strong>probeStep, E0 … etc.</strong></dt>
<dd><p class="first last">See function simulate_with_prismatic()</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>Simulated image as a hyperspy object</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p># &gt;&gt;&gt; simulate_and_calibrate_with_prismatic()
######## need to include an example reference_image here</p>
</dd></dl>

<dl class="function">
<dt id="temul.simulations.simulate_and_filter_and_calibrate_with_prismatic">
<code class="descclassname">temul.simulations.</code><code class="descname">simulate_and_filter_and_calibrate_with_prismatic</code><span class="sig-paren">(</span><em>xyz_filename</em>, <em>filename</em>, <em>reference_image</em>, <em>calibration_area</em>, <em>calibration_separation</em>, <em>delta_image_filter=0.1</em>, <em>max_sigma=6</em>, <em>percent_to_nn=0.4</em>, <em>mask_radius=None</em>, <em>refine=True</em>, <em>scalebar_true=False</em>, <em>probeStep=None</em>, <em>E0=60000.0</em>, <em>integrationAngleMin=0.085</em>, <em>integrationAngleMax=0.186</em>, <em>interpolationFactor=16</em>, <em>realspacePixelSize=0.0654</em>, <em>numFP=1</em>, <em>probeSemiangle=0.03</em>, <em>alphaBeamMax=0.032</em>, <em>scanWindowMin=0.0</em>, <em>scanWindowMax=1.0</em>, <em>algorithm='prism'</em>, <em>numThreads=2</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.simulations.simulate_and_filter_and_calibrate_with_prismatic" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate an xyz coordinate model with pyprismatic
fast simulation software.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>xyz_filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">filename of the xyz coordinate model. Must be in the prismatic format.
See <a class="reference external" href="http://prism-em.com/docs-inputs/">http://prism-em.com/docs-inputs/</a> for more information.</p>
</dd>
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, default None</span></dt>
<dd><p class="first last">name with which the image will be saved</p>
</dd>
<dt><strong>reference_image</strong> <span class="classifier-delimiter">:</span> <span class="classifier">hyperspy signal 2D</span></dt>
<dd><p class="first last">image from which calibration information is taken, such
as sampling, pixel height and pixel width</p>
</dd>
<dt><strong>calibration_area</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd><p class="first last">xy pixel coordinates of the image area to be used to calibrate
the intensity. In the form [[0,0], [512,512]]
See calibrate_intensity_distance_with_sublattice_roi()</p>
</dd>
<dt><strong>calibration_separation</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">pixel separation used for the intensity calibration.
See calibrate_intensity_distance_with_sublattice_roi()</p>
</dd>
<dt><strong>percent_to_nn</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default 0.40</span></dt>
<dd><p class="first last">Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</p>
</dd>
<dt><strong>mask_radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default None</span></dt>
<dd><p class="first last">Radius of the mask around each atom. If this is not set,
the radius will be the distance to the nearest atom in the
same sublattice times the <cite>percent_to_nn</cite> value.
Note: if <cite>mask_radius</cite> is not specified, the Atom_Position objects
must have a populated nearest_neighbor_list.</p>
</dd>
<dt><strong>refine, scalebar_true</strong></dt>
<dd><p class="first last">See function calibrate_intensity_distance_with_sublattice_roi()</p>
</dd>
<dt><strong>probeStep, E0 … etc.</strong></dt>
<dd><p class="first last">See function simulate_with_prismatic()</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>Simulated image as a hyperspy object</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p># &gt;&gt;&gt; simulate_and_calibrate_with_prismatic()
######## need to include an example reference_image here</p>
</dd></dl>

<dl class="function">
<dt id="temul.simulations.simulate_with_prismatic">
<code class="descclassname">temul.simulations.</code><code class="descname">simulate_with_prismatic</code><span class="sig-paren">(</span><em>xyz_filename</em>, <em>filename</em>, <em>reference_image=None</em>, <em>probeStep=1.0</em>, <em>E0=60000.0</em>, <em>integrationAngleMin=0.085</em>, <em>integrationAngleMax=0.186</em>, <em>detectorAngleStep=0.001</em>, <em>interpolationFactor=16</em>, <em>realspacePixelSize=0.0654</em>, <em>numFP=1</em>, <em>cellDimXYZ=None</em>, <em>tileXYZ=None</em>, <em>probeSemiangle=0.03</em>, <em>alphaBeamMax=0.032</em>, <em>scanWindowMin=0.0</em>, <em>scanWindowMax=1.0</em>, <em>algorithm='prism'</em>, <em>numThreads=2</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.simulations.simulate_with_prismatic" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate an xyz coordinate model with pyprismatic
fast simulation software.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>xyz_filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">filename of the xyz coordinate model. Must be in the prismatic format.
See <a class="reference external" href="http://prism-em.com/docs-inputs/">http://prism-em.com/docs-inputs/</a> for more information.</p>
</dd>
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, default None</span></dt>
<dd><p class="first last">name with which the image will be saved</p>
</dd>
<dt><strong>reference_image</strong> <span class="classifier-delimiter">:</span> <span class="classifier">hyperspy signal 2D</span></dt>
<dd><p class="first last">image from which calibration information is taken, such
as sampling, pixel height and pixel width</p>
</dd>
<dt><strong>probeStep</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default 1.0</span></dt>
<dd><p class="first last">Should be the sampling of the image, where
sampling = length (in angstrom)/pixels
If you want the probeStep to be calculated from the reference image,
set this to None.</p>
</dd>
<dt><strong>E0, numThreads etc.,</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Prismatic parameters</span></dt>
<dd><p class="first last">See <a class="reference external" href="http://prism-em.com/docs-params/">http://prism-em.com/docs-params/</a></p>
</dd>
<dt><strong>cellDimXYZ</strong> <span class="classifier-delimiter">:</span> <span class="classifier">tuple, default None</span></dt>
<dd><p class="first last">A tuple of length 3. Example (2.3, 4.5, 5.6).
If this is set to None, the cell dimension values from the .xyz file
will be used (default). If it is specified, it will overwrite the .xyz
file values.</p>
</dd>
<dt><strong>tileXYZ</strong> <span class="classifier-delimiter">:</span> <span class="classifier">tuple, deault None</span></dt>
<dd><p class="first last">A tuple of length 3. Example (5, 5, 2) would multiply the model in x
and y by 5, and z by 2.
Default of None is just set to (1, 1, 1)</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>Simulated image as a 2D mrc file</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.simulations</span> <span class="k">import</span> <span class="n">simulate_with_prismatic</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simulate_with_prismatic</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">xyz_filename</span><span class="o">=</span><span class="s2">&quot;example_data/prismatic/&quot;</span>
<span class="gp">... </span>        <span class="s2">&quot;MoS2_hex_prismatic.xyz&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;prismatic_simulation&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">probeStep</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">reference_image</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">E0</span><span class="o">=</span><span class="mf">60e3</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">integrationAngleMin</span><span class="o">=</span><span class="mf">0.085</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">integrationAngleMax</span><span class="o">=</span><span class="mf">0.186</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">interpolationFactor</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">realspacePixelSize</span><span class="o">=</span><span class="mf">0.0654</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">numFP</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">probeSemiangle</span><span class="o">=</span><span class="mf">0.030</span><span class="p">,</span> <span class="n">alphaBeamMax</span><span class="o">=</span><span class="mf">0.032</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">scanWindowMin</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">scanWindowMax</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;prism&quot;</span><span class="p">,</span> <span class="n">numThreads</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-temul.signal_processing">
<span id="signal-processing"></span><h3>Signal Processing<a class="headerlink" href="#module-temul.signal_processing" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="temul.signal_processing.calibrate_intensity_distance_with_sublattice_roi">
<code class="descclassname">temul.signal_processing.</code><code class="descname">calibrate_intensity_distance_with_sublattice_roi</code><span class="sig-paren">(</span><em>image</em>, <em>cropping_area</em>, <em>separation</em>, <em>filename=None</em>, <em>reference_image=None</em>, <em>percent_to_nn=0.2</em>, <em>mask_radius=None</em>, <em>refine=True</em>, <em>scalebar_true=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.calibrate_intensity_distance_with_sublattice_roi" title="Permalink to this definition">¶</a></dt>
<dd><p>Calibrates the intensity of an image by using a sublattice, found with some
atomap functions. The mean intensity of that sublattice is set to 1</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>image</strong> <span class="classifier-delimiter">:</span> <span class="classifier">HyperSpy 2D signal, default None</span></dt>
<dd><p class="first last">The signal can be distance calibrated. If it is, set
scalebar_true=True</p>
</dd>
<dt><strong>cropping_area</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of 2 floats, default None</span></dt>
<dd><p class="first last">The best method of choosing the area is by using the atomap
function “add_atoms_with_gui(image.data)”. Choose two points on the
image. First point is top left of area, second point is bottom right.</p>
</dd>
<dt><strong>percent_to_nn</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default 0.40</span></dt>
<dd><p class="first last">Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</p>
</dd>
<dt><strong>scalebar_true</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Bool, default False</span></dt>
<dd><p class="first last">Set to True if the scale of the image is calibrated to a distance unit.
<strong>* is there any point to this? if scale=1, then multiplying has no
*</strong> effect, and if it is scaled to nm or angstrom, multiplying is
<a href="#id3"><span class="problematic" id="id4">**</span></a>* good. so keep the code, remove the parameter option!</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>calibrated image data</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.choose_mask_coordinates">
<code class="descclassname">temul.signal_processing.</code><code class="descname">choose_mask_coordinates</code><span class="sig-paren">(</span><em>image</em>, <em>norm='log'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.choose_mask_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Pick the mask locations for an FFT.
See get_masked_ifft() and
atomap.initial_position_finding.add_atoms_with_gui() for more details.
Commit 5ba307b5af0b598bedc0284aa989d44e23fdde4d on Atomap</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>image</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Hyperspy 2D Signal</span></dt>
<dd></dd>
<dt><strong>norm</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, default ‘log’</span></dt>
<dd><p class="first last">How to scale the intensity value for the displayed image.
Options are ‘linear’ and ‘log’</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>mask_coords</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of pixel coordinates</span></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>See get_masked_ifft() for example.</p>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.compare_two_image_and_create_filtered_image">
<code class="descclassname">temul.signal_processing.</code><code class="descname">compare_two_image_and_create_filtered_image</code><span class="sig-paren">(</span><em>image_to_filter</em>, <em>reference_image</em>, <em>delta_image_filter</em>, <em>cropping_area</em>, <em>separation</em>, <em>filename=None</em>, <em>max_sigma=6</em>, <em>percent_to_nn=0.4</em>, <em>mask_radius=None</em>, <em>refine=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.compare_two_image_and_create_filtered_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Gaussian blur an image for comparison with a reference image.
Good for finding the best gaussian blur for a simulation by
comparing to an experimental image.
See measure_image_errors() and load_and_compare_images()</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.signal_processing</span> <span class="k">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">compare_two_image_and_create_filtered_image</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.example_data</span> <span class="k">as</span> <span class="nn">example_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">experiment</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">load_Se_implanted_MoS2_data</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simulation</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">load_Se_implanted_MoS2_simulation</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_image</span> <span class="o">=</span> <span class="n">compare_two_image_and_create_filtered_image</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">simulation</span><span class="p">,</span> <span class="n">experiment</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">cropping_area</span><span class="o">=</span><span class="p">[[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">]],</span>
<span class="gp">... </span>    <span class="n">separation</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">mask_radius</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">percent_to_nn</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.crop_image_hs">
<code class="descclassname">temul.signal_processing.</code><code class="descname">crop_image_hs</code><span class="sig-paren">(</span><em>image</em>, <em>cropping_area</em>, <em>save_image=True</em>, <em>save_variables=True</em>, <em>scalebar_true=True</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.crop_image_hs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.signal_processing.distance_vector">
<code class="descclassname">temul.signal_processing.</code><code class="descname">distance_vector</code><span class="sig-paren">(</span><em>x1</em>, <em>y1</em>, <em>x2</em>, <em>y2</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.distance_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.signal_processing.double_gaussian_fft_filter">
<code class="descclassname">temul.signal_processing.</code><code class="descname">double_gaussian_fft_filter</code><span class="sig-paren">(</span><em>image</em>, <em>filename</em>, <em>d_inner</em>, <em>d_outer</em>, <em>real_space_sampling</em>, <em>delta=0.05</em>, <em>units='nm'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.double_gaussian_fft_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Example d_inner, d_outer:
MoS2: d_1 = 7.7, d_2 = 14</p>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.fit_1D_gaussian_to_data">
<code class="descclassname">temul.signal_processing.</code><code class="descname">fit_1D_gaussian_to_data</code><span class="sig-paren">(</span><em>xdata</em>, <em>amp</em>, <em>mu</em>, <em>sigma</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.fit_1D_gaussian_to_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Fitting function for a single 1D gaussian distribution</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>xdata</strong> <span class="classifier-delimiter">:</span> <span class="classifier">numpy 1D array</span></dt>
<dd><p class="first last">values input as the x coordinates of the gaussian distribution</p>
</dd>
<dt><strong>amp</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">amplitude of the gaussian in y-axis</p>
</dd>
<dt><strong>mu</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">mean value of the gaussianin x-axis, corresponding to y-axis
amplitude.</p>
</dd>
<dt><strong>sigma</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">standard deviation of the gaussian distribution</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>gaussian distibution of xdata array</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.signal_processing</span> <span class="k">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">get_xydata_from_list_of_intensities</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">fit_1D_gaussian_to_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amp</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub1_inten</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span> <span class="o">=</span> <span class="n">get_xydata_from_list_of_intensities</span><span class="p">(</span><span class="n">sub1_inten</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">hist_bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gauss_fit_01</span> <span class="o">=</span> <span class="n">fit_1D_gaussian_to_data</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">amp</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.get_cell_image">
<code class="descclassname">temul.signal_processing.</code><code class="descname">get_cell_image</code><span class="sig-paren">(</span><em>s</em>, <em>points_x</em>, <em>points_y</em>, <em>method='Voronoi'</em>, <em>max_radius='Auto'</em>, <em>reduce_func=&lt;function amin&gt;</em>, <em>show_progressbar=True</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.get_cell_image" title="Permalink to this definition">¶</a></dt>
<dd><p>The same as atomap’s integrate, except instead of summing the
region around an atom, it removes the value from all pixels in
that region.
For example, with this you can remove the local background intensity
by setting reduce_func=np.min.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>See atomap’s integrate function.</strong></dt>
<dd></dd>
<dt><strong>reduce_func</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ufunc, default np.min</span></dt>
<dd><p class="first last">function used to reduce the pixel values around each atom
to a float.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>Numpy array with the same shape as s</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>#### add PTO example from paper</p>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.get_fitting_tools_for_plotting_gaussians">
<code class="descclassname">temul.signal_processing.</code><code class="descname">get_fitting_tools_for_plotting_gaussians</code><span class="sig-paren">(</span><em>element_list</em>, <em>scaled_middle_intensity_list</em>, <em>scaled_limit_intensity_list</em>, <em>fit_bright_first=True</em>, <em>gaussian_amp=5</em>, <em>gauss_sigma_division=100</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.get_fitting_tools_for_plotting_gaussians" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a list of parameters and details for fitting the intensities of a
sublattice with multiple Gaussians.</p>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.get_masked_ifft">
<code class="descclassname">temul.signal_processing.</code><code class="descname">get_masked_ifft</code><span class="sig-paren">(</span><em>image</em>, <em>mask_coords</em>, <em>mask_radius=10</em>, <em>space='real'</em>, <em>keep_masked_area=True</em>, <em>plot_masked_fft=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.get_masked_ifft" title="Permalink to this definition">¶</a></dt>
<dd><p>loop through each mask_coords and mask the fft. Then return
an ifft of the image.
To Do: calibration of units automatically.</p>
<p>Masks a fast Fourier transform (FFT) and returns the inverse FFT.
Use choose_mask_coordinates() to manually choose mask coordinates in the
FFT.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>image</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Hyperspy 2D Signal</span></dt>
<dd></dd>
<dt><strong>mask_coords</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of lists</span></dt>
<dd><p class="first last">Pixel coordinates of the masking locations. See the example below for
two simple coordinates.</p>
</dd>
<dt><strong>mask_radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, default 10</span></dt>
<dd><p class="first last">Radius in pixels of the mask.</p>
</dd>
<dt><strong>space</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, default “real”</span></dt>
<dd><p class="first last">If the input image is a Fourier transform already, set space=”fourier”</p>
</dd>
<dt><strong>keep_masked_area</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Bool, default True</span></dt>
<dd><p class="first last">If True, this will set the mask at the mask_coords.
If False, this will set the mask as everything other than the
mask_coords.</p>
</dd>
<dt><strong>plot_masked_fft</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Bool, default False</span></dt>
<dd><p class="first last">If True, the mask used to filter the FFT will be plotted. Good for
checking that the mask is doing what you want.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>Inverse FFT as a Hyperspy 2D Signal</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="k">import</span> <span class="n">get_simple_cubic_signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.signal_processing</span> <span class="k">as</span> <span class="nn">tmlsp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">get_simple_cubic_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask_coords</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">170.2</span><span class="p">,</span> <span class="mf">170.8</span><span class="p">],[</span><span class="mf">129.8</span><span class="p">,</span> <span class="mi">130</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># mask_coords = tmlsp.choose_mask_coordinates(image=image, norm=&#39;log&#39;)</span>
</pre></div>
</div>
<p>Use the defaults:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image_ifft</span> <span class="o">=</span> <span class="n">tmlsp</span><span class="o">.</span><span class="n">get_masked_ifft</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span> <span class="n">mask_coords</span><span class="o">=</span><span class="n">mask_coords</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_ifft</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>Plot the masked fft:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image_ifft</span> <span class="o">=</span> <span class="n">tmlsp</span><span class="o">.</span><span class="n">get_masked_ifft</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span> <span class="n">mask_coords</span><span class="o">=</span><span class="n">mask_coords</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">plot_masked_fft</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_ifft</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>Use unmasked fft area and plot the masked fft:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image_ifft</span> <span class="o">=</span> <span class="n">tmlsp</span><span class="o">.</span><span class="n">get_masked_ifft</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span> <span class="n">mask_coords</span><span class="o">=</span><span class="n">mask_coords</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">plot_masked_fft</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_masked_area</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_ifft</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>If the input image is already a Fourier transform:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fft_image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">shift</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_ifft</span> <span class="o">=</span> <span class="n">tmlsp</span><span class="o">.</span><span class="n">get_masked_ifft</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">image</span><span class="o">=</span><span class="n">fft_image</span><span class="p">,</span> <span class="n">mask_coords</span><span class="o">=</span><span class="n">mask_coords</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">space</span><span class="o">=</span><span class="s1">&#39;fourier&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_ifft</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.get_scaled_middle_limit_intensity_list">
<code class="descclassname">temul.signal_processing.</code><code class="descname">get_scaled_middle_limit_intensity_list</code><span class="sig-paren">(</span><em>sublattice</em>, <em>middle_intensity_list</em>, <em>limit_intensity_list</em>, <em>sublattice_scalar</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.get_scaled_middle_limit_intensity_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the middle and limit lists scaled to the actual intensities in the
sublattice. Useful for get_fitting_tools_for_plotting_gaussians().</p>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.get_xydata_from_list_of_intensities">
<code class="descclassname">temul.signal_processing.</code><code class="descname">get_xydata_from_list_of_intensities</code><span class="sig-paren">(</span><em>sublattice_intensity_list</em>, <em>hist_bins=100</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.get_xydata_from_list_of_intensities" title="Permalink to this definition">¶</a></dt>
<dd><p>Output x and y data for a histogram of intensities</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>sublattice_intensity_list</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd><p class="first last">See get_subattice_intensity() for more information</p>
</dd>
<dt><strong>hist_bins</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, default 100</span></dt>
<dd><p class="first last">number of bins to sort the intensities into
must be a better way of doing this? maybe automate the binning choice</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>Two numpy 1D arrays corressponding to the x and y values of a histogram</strong></dt>
<dd></dd>
<dt><strong>of the sublattice intensities.</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.signal_processing</span> <span class="k">import</span> <span class="n">get_xydata_from_list_of_intensities</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amp</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub1_inten</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span> <span class="o">=</span> <span class="n">get_xydata_from_list_of_intensities</span><span class="p">(</span><span class="n">sub1_inten</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">hist_bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.load_and_compare_images">
<code class="descclassname">temul.signal_processing.</code><code class="descname">load_and_compare_images</code><span class="sig-paren">(</span><em>imageA</em>, <em>imageB</em>, <em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.load_and_compare_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Load two images and compare their mean standard error and structural
simularity index.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>imageA, imageB</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">filename of the images to be loaded and compared</p>
</dd>
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, default None</span></dt>
<dd><p class="first last">name with which the image will be saved</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>mean standard error and structural simularity index</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p># &gt;&gt;&gt; # has to be a name for hyperspy to open with hs.load!!!
# &gt;&gt;&gt; imageA = am.dummy_data.get_simple_cubic_signal(image_noise=True)
# &gt;&gt;&gt; imageB = am.dummy_data.get_simple_cubic_signal()
# &gt;&gt;&gt; load_and_compare_images(imageA, imageB, filename=None)</p>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.make_gaussian">
<code class="descclassname">temul.signal_processing.</code><code class="descname">make_gaussian</code><span class="sig-paren">(</span><em>size</em>, <em>fwhm</em>, <em>center</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.make_gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a square gaussian kernel.</p>
<p>size is the length of a side of the square
fwhm is full-width-half-maximum, which
can be thought of as an effective radius.</p>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.mean_and_std_nearest_neighbour_distances">
<code class="descclassname">temul.signal_processing.</code><code class="descname">mean_and_std_nearest_neighbour_distances</code><span class="sig-paren">(</span><em>sublattice</em>, <em>nearest_neighbours=5</em>, <em>sampling=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.mean_and_std_nearest_neighbour_distances" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates mean and standard deviation of the distance from each atom to
its nearest neighbours.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>sublattice</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Atomap Sublattice object</span></dt>
<dd></dd>
<dt><strong>nearest_neighbours</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, default 5</span></dt>
<dd><p class="first last">The number of nearest neighbours used to calculate the mean distance
from an atom. As in atomap, choosing 5 gets the 4 nearest
neighbours.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>2 lists: list of mean distances, list of standard deviations.</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="k">import</span> <span class="n">get_simple_cubic_sublattice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.signal_processing</span> <span class="k">as</span> <span class="nn">tmlsp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub1</span> <span class="o">=</span> <span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">tmlsp</span><span class="o">.</span><span class="n">mean_and_std_nearest_neighbour_distances</span><span class="p">(</span><span class="n">sub1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mean_scaled</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">tmlsp</span><span class="o">.</span><span class="n">mean_and_std_nearest_neighbour_distances</span><span class="p">(</span><span class="n">sub1</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">nearest_neighbours</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">sampling</span><span class="o">=</span><span class="mf">0.0123</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.measure_image_errors">
<code class="descclassname">temul.signal_processing.</code><code class="descname">measure_image_errors</code><span class="sig-paren">(</span><em>imageA</em>, <em>imageB</em>, <em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.measure_image_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>Measure the Mean Squared Error (mse) and Structural Similarity Index (ssm)
between two images.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>imageA, imageB</strong> <span class="classifier-delimiter">:</span> <span class="classifier">2D NumPy array, default None</span></dt>
<dd><p class="first last">Two images between which to measure mse and ssm</p>
</dd>
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, default None</span></dt>
<dd><p class="first last">name with which the image will be saved</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>mse_number, ssm_number</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd></dd>
<dt><strong>returned subtracted image is imageA - imageB</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.mse">
<code class="descclassname">temul.signal_processing.</code><code class="descname">mse</code><span class="sig-paren">(</span><em>imageA</em>, <em>imageB</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.mse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.signal_processing.plot_gaussian_fit">
<code class="descclassname">temul.signal_processing.</code><code class="descname">plot_gaussian_fit</code><span class="sig-paren">(</span><em>xdata</em>, <em>ydata</em>, <em>function</em>, <em>amp</em>, <em>mu</em>, <em>sigma</em>, <em>gauss_art='r--'</em>, <em>gauss_label='Gauss Fit'</em>, <em>plot_data=True</em>, <em>data_art='ko'</em>, <em>data_label='Data Points'</em>, <em>plot_fill=False</em>, <em>facecolor='r'</em>, <em>alpha=0.5</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.plot_gaussian_fit" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.signal_processing</span> <span class="k">import</span> <span class="p">(</span><span class="n">fit_1D_gaussian_to_data</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">plot_gaussian_fit</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">return_fitting_of_1D_gaussian</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amp</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub1_inten</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span> <span class="o">=</span> <span class="n">get_xydata_from_list_of_intensities</span><span class="p">(</span><span class="n">sub1_inten</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">hist_bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">popt_gauss</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">return_fitting_of_1D_gaussian</span><span class="p">(</span>
<span class="gp">... </span>                    <span class="n">fit_1D_gaussian_to_data</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">amp</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_gaussian_fit</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="n">fit_1D_gaussian_to_data</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">amp</span><span class="o">=</span><span class="n">popt_gauss</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mu</span><span class="o">=</span><span class="n">popt_gauss</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sigma</span><span class="o">=</span><span class="n">popt_gauss</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>          <span class="n">gauss_art</span><span class="o">=</span><span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">gauss_label</span><span class="o">=</span><span class="s1">&#39;Gauss Fit&#39;</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">plot_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">data_art</span><span class="o">=</span><span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">data_label</span><span class="o">=</span><span class="s1">&#39;Data Points&#39;</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">plot_fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.plot_gaussian_fitting_for_multiple_fits">
<code class="descclassname">temul.signal_processing.</code><code class="descname">plot_gaussian_fitting_for_multiple_fits</code><span class="sig-paren">(</span><em>sub_ints_all, fitting_tools_all_subs, element_list_all_subs, marker_list, hist_bins=150, plotting_style='hist', filename='Fit of Intensities', mpl_cmaps_list=['viridis']</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.plot_gaussian_fitting_for_multiple_fits" title="Permalink to this definition">¶</a></dt>
<dd><p>plots Gaussian distributions for intensities of a sublattice, over the
given parameters (fitting tools).</p>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.remove_image_intensity_in_data_slice">
<code class="descclassname">temul.signal_processing.</code><code class="descname">remove_image_intensity_in_data_slice</code><span class="sig-paren">(</span><em>atom</em>, <em>image_data</em>, <em>percent_to_nn=0.5</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.remove_image_intensity_in_data_slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove intensity from the area around an atom in a
sublattice</p>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.return_fitting_of_1D_gaussian">
<code class="descclassname">temul.signal_processing.</code><code class="descname">return_fitting_of_1D_gaussian</code><span class="sig-paren">(</span><em>function</em>, <em>xdata</em>, <em>ydata</em>, <em>amp</em>, <em>mu</em>, <em>sigma</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.return_fitting_of_1D_gaussian" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Use the initially found centre (mean/mode) value of a sublattice
histogram (e.g., Mo_1 in an Mo sublattice) as an input mean for a
gaussian fit of the data.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>xdata, ydata</strong> <span class="classifier-delimiter">:</span> <span class="classifier">see scipy.optimize.curve_fit</span></dt>
<dd><p class="first last">amp, mu, sigma : see fit_1D_gaussian_to_data() for more details</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>optimised parameters (popt) and estimated covariance (pcov) of the</strong></dt>
<dd><p class="first last">fitted gaussian function.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p>Fitted Mean: ” + str(round(popt_gauss[1],3)))</p>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.rigid_registration">
<code class="descclassname">temul.signal_processing.</code><code class="descname">rigid_registration</code><span class="sig-paren">(</span><em>file</em>, <em>masktype='hann'</em>, <em>n=4</em>, <em>findMaxima='gf'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.rigid_registration" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform image registraion with the rigid registration package</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>file</strong> <span class="classifier-delimiter">:</span> <span class="classifier">stack of tiff images</span></dt>
<dd></dd>
<dt><strong>masktype</strong> <span class="classifier-delimiter">:</span> <span class="classifier">filtering method, default ‘hann’</span></dt>
<dd><p class="first last">See <a class="reference external" href="https://github.com/bsavitzky/rigidRegistration">https://github.com/bsavitzky/rigidRegistration</a> for
more information</p>
</dd>
<dt><strong>n</strong> <span class="classifier-delimiter">:</span> <span class="classifier">width of filter, default 4</span></dt>
<dd><p class="first last">larger numbers mean smaller filter width
See <a class="reference external" href="https://github.com/bsavitzky/rigidRegistration">https://github.com/bsavitzky/rigidRegistration</a> for
more information</p>
</dd>
<dt><strong>findMaxima</strong> <span class="classifier-delimiter">:</span> <span class="classifier">image matching method, default ‘gf’</span></dt>
<dd><p class="first last">‘pixel’ and ‘gf’ options, See
<a class="reference external" href="https://github.com/bsavitzky/rigidRegistration">https://github.com/bsavitzky/rigidRegistration</a> for
more information</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>Outputs of</strong></dt>
<dd></dd>
<dt><strong>report of the image registration</strong></dt>
<dd></dd>
<dt><strong>aligned and stacked image with and without crop</strong></dt>
<dd></dd>
<dt><strong>creates a folder and places all uncropped aligned images in it</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.toggle_atom_refine_position_automatically">
<code class="descclassname">temul.signal_processing.</code><code class="descname">toggle_atom_refine_position_automatically</code><span class="sig-paren">(</span><em>sublattice</em>, <em>min_cut_off_percent</em>, <em>max_cut_off_percent</em>, <em>filename=None</em>, <em>range_type='internal'</em>, <em>method='mode'</em>, <em>percent_to_nn=0.05</em>, <em>mask_radius=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.toggle_atom_refine_position_automatically" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the ‘refine_position’ attribute of each Atom Position in a
sublattice using a range of intensities.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>sublattice</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Atomap Sublattice object, default None</span></dt>
<dd></dd>
<dt><strong>min_cut_off_percent</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default None</span></dt>
<dd><p class="first last">The lower end of the intensity range is defined as
min_cut_off_percent * modal value of max intensity list of
sublattice.</p>
</dd>
<dt><strong>max_cut_off_percent</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default None</span></dt>
<dd><p class="first last">The upper end of the intensity range is defined as
max_cut_off_percent * modal value of max intensity list of
sublattice.</p>
</dd>
<dt><strong>range_type</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, default ‘internal’</span></dt>
<dd><p class="first last">‘internal’ returns the ‘refine_position’ attribute for each
Atom Position as True if the intensity of that Atom Position
lies between the lower and upper limits defined by min_cut_off_percent
and max_cut_off_percent.
‘external’ returns the ‘refine_position’ attribute for each
Atom Position as True if the intensity of that Atom Position
lies outside the lower and upper limits defined by min_cut_off_percent
and max_cut_off_percent.</p>
</dd>
<dt><strong>save_image</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Bool, default False</span></dt>
<dd><p class="first last">Save the ‘sublattice.toggle_atom_refine_position_with_gui()’
image.</p>
</dd>
<dt><strong>percent_to_nn</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default 0.40</span></dt>
<dd><p class="first last">Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>calibrated image data</strong></dt>
<dd></dd>
<dt><strong>Example</strong></dt>
<dd></dd>
<dt><strong>——-</strong></dt>
<dd></dd>
<dt><strong>&gt;&gt;&gt; min_cut_off_percent = 0.75</strong></dt>
<dd></dd>
<dt><strong>&gt;&gt;&gt; max_cut_off_percent = 1.25</strong></dt>
<dd></dd>
<dt><strong>&gt;&gt;&gt; sublattice = am.dummy_data.get_simple_cubic_with_vacancies_sublattice(</strong></dt>
<dd></dd>
<dt><strong>…     image_noise=True)</strong></dt>
<dd></dd>
<dt><strong>&gt;&gt;&gt; sublattice.find_nearest_neighbors()</strong></dt>
<dd></dd>
<dt><strong>&gt;&gt;&gt; sublattice.plot()</strong></dt>
<dd></dd>
<dt><strong>&gt;&gt;&gt; false_list_sublattice =  toggle_atom_refine_position_automatically(</strong></dt>
<dd></dd>
<dt><strong>…                             sublattice=sublattice,</strong></dt>
<dd></dd>
<dt><strong>…                             min_cut_off_percent=min_cut_off_percent,</strong></dt>
<dd></dd>
<dt><strong>…                             max_cut_off_percent=max_cut_off_percent,</strong></dt>
<dd></dd>
<dt><strong>…                             range_type=’internal’,</strong></dt>
<dd></dd>
<dt><strong>…                             method=’mode’,</strong></dt>
<dd></dd>
<dt><strong>…                             percent_to_nn=0.05)</strong></dt>
<dd></dd>
<dt><strong>&gt;&gt;&gt; # Check which atoms will not be refined (red dots)</strong></dt>
<dd></dd>
<dt><strong>&gt;&gt;&gt; sublattice.toggle_atom_refine_position_with_gui()</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-temul.signal_plotting">
<span id="signal-plotting"></span><h3>Signal Plotting<a class="headerlink" href="#module-temul.signal_plotting" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="temul.signal_plotting.compare_images_line_profile_one_image">
<code class="descclassname">temul.signal_plotting.</code><code class="descname">compare_images_line_profile_one_image</code><span class="sig-paren">(</span><em>image</em>, <em>line_profile_positions</em>, <em>linewidth=1</em>, <em>image_sampling='Auto'</em>, <em>arrow=None</em>, <em>linetrace=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.compare_images_line_profile_one_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots two line profiles on one image with the line profile intensities
in a subfigure.
See skimage PR PinkShnack for details on implementing profile_line
in skimage</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>image</strong> <span class="classifier-delimiter">:</span> <span class="classifier">2D Hyperspy signal</span></dt>
<dd></dd>
<dt><strong>line_profile_positions</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of lists</span></dt>
<dd><p class="first last">two line profile coordinates. Use atomap’s am.add_atoms_with_gui()
function to get these. The first two dots will trace the first line
profile etc.
Could be extended to n positions with a basic loop.</p>
</dd>
<dt><strong>linewidth</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, default 1</span></dt>
<dd><p class="first last">see profile_line for parameter details.</p>
</dd>
<dt><strong>image_sampling</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default ‘Auto’</span></dt>
<dd><blockquote class="first">
<div><p>if set to ‘Auto’ the function will attempt to find the sampling of
image from image.axes_manager[0].scale.</p>
</div></blockquote>
<dl class="last docutils">
<dt>arrow <span class="classifier-delimiter">:</span> <span class="classifier">string, default None</span></dt>
<dd><p class="first last">If set, arrows will be plotting on the image. Options are ‘h’ and
‘v’ for horizontal and vertical arrows, respectively.</p>
</dd>
</dl>
</dd>
<dt><strong>linetrace</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, default None</span></dt>
<dd><p class="first last">If set, the line profile will be plotted on the image.
The thickness of the linetrace will be linewidth*linetrace.
Name could be improved maybe.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Include PTO example from paper</p>
</dd></dl>

<dl class="function">
<dt id="temul.signal_plotting.compare_images_line_profile_two_images">
<code class="descclassname">temul.signal_plotting.</code><code class="descname">compare_images_line_profile_two_images</code><span class="sig-paren">(</span><em>imageA</em>, <em>imageB</em>, <em>line_profile_positions</em>, <em>reduce_func=&lt;function mean&gt;</em>, <em>linewidth=1</em>, <em>image_sampling='auto'</em>, <em>scale_units='nm'</em>, <em>crop_offset=20</em>, <em>title='Intensity Profile'</em>, <em>marker_A='^'</em>, <em>marker_B='o'</em>, <em>arrow_markersize=10</em>, <em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.compare_images_line_profile_two_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots two line profiles on two images separately with the line
profile intensities in a subfigure.
See skimage PR PinkShnack for details on implementing profile_line
in skimage: <a class="reference external" href="https://github.com/scikit-image/scikit-image/pull/4206">https://github.com/scikit-image/scikit-image/pull/4206</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>imageA, imageB</strong> <span class="classifier-delimiter">:</span> <span class="classifier">2D Hyperspy signal</span></dt>
<dd></dd>
<dt><strong>line_profile_positions</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of lists</span></dt>
<dd><p class="first last">one line profile coordinate. Use atomap’s am.add_atoms_with_gui()
function to get these. The two dots will trace the line profile.
See Examples below for example.</p>
</dd>
<dt><strong>linewidth</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, default 1</span></dt>
<dd><p class="first last">see profile_line for parameter details.</p>
</dd>
<dt><strong>image_sampling</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default ‘auto’</span></dt>
<dd><p class="first last">if set to ‘auto’ the function will attempt to find the sampling of
image from image.axes_manager[0].scale.</p>
</dd>
<dt><strong>scale_units</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, default ‘nm’</span></dt>
<dd></dd>
<dt><strong>crop_offset</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, default 20</span></dt>
<dd><p class="first last">number of pixels away from the <cite>line_profile_positions</cite> coordinates the
image crop will be taken.</p>
</dd>
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, default None</span></dt>
<dd><p class="first last">If this is set to a name (string), the image will be saved with that
name.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.signal_plotting</span> <span class="k">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">compare_images_line_profile_two_images</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imageA</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_signal</span><span class="p">(</span><span class="n">image_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imageB</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># line_profile_positions = am.add_atoms_with_gui(imageA)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">line_profile_positions</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">81.58</span><span class="p">,</span> <span class="mf">69.70</span><span class="p">],</span> <span class="p">[</span><span class="mf">193.10</span><span class="p">,</span> <span class="mf">184.08</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">compare_images_line_profile_two_images</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">imageA</span><span class="p">,</span> <span class="n">imageB</span><span class="p">,</span> <span class="n">line_profile_positions</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">image_sampling</span><span class="o">=</span><span class="mf">0.012</span><span class="p">,</span> <span class="n">crop_offset</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
<p>To use the new skimage functionality try <cite>reduce_func</cite>
&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; reduce_func = np.sum # can be any ufunc!
&gt;&gt;&gt; compare_images_line_profile_two_images(
…     imageA, imageB, line_profile_positions, reduce_func=reduce_func,
…     linewidth=3, image_sampling=0.012, crop_offset=30)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">reduce_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">compare_images_line_profile_two_images</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">imageA</span><span class="p">,</span> <span class="n">imageB</span><span class="p">,</span> <span class="n">line_profile_positions</span><span class="p">,</span> <span class="n">reduce_func</span><span class="o">=</span><span class="n">reduce_func</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">image_sampling</span><span class="o">=</span><span class="mf">0.012</span><span class="p">,</span> <span class="n">crop_offset</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.example_data</span> <span class="k">as</span> <span class="nn">example_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imageA</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">load_Se_implanted_MoS2_data</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imageB</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">load_Se_implanted_MoS2_data</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">line_profile_positions</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">301.42</span><span class="p">,</span> <span class="mf">318.9</span><span class="p">],</span> <span class="p">[</span><span class="mf">535.92</span><span class="p">,</span> <span class="mf">500.82</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">compare_images_line_profile_two_images</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">imageA</span><span class="p">,</span> <span class="n">imageB</span><span class="p">,</span> <span class="n">line_profile_positions</span><span class="p">,</span> <span class="n">reduce_func</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>Include PTO example from paper</p>
</dd></dl>

</div>
<div class="section" id="module-temul.io">
<span id="input-output-io"></span><h3>Input/Output (io)<a class="headerlink" href="#module-temul.io" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="temul.io.batch_convert_emd_to_image">
<code class="descclassname">temul.io.</code><code class="descname">batch_convert_emd_to_image</code><span class="sig-paren">(</span><em>extension_to_save</em>, <em>top_level_directory</em>, <em>glob_search='**/*'</em>, <em>overwrite=True</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.batch_convert_emd_to_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert all .emd files to the chosen extension_to_save file format in the
specified directory and all subdirectories.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>extension_to_save</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the image file extension to be used for saving the image.
See Hyperspy documentation for information on file writing extensions
available: <a class="reference external" href="http://hyperspy.org/hyperspy-doc/current/user_guide/io.html">http://hyperspy.org/hyperspy-doc/current/user_guide/io.html</a></p>
</dd>
<dt><strong>top_level_directory</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">The top-level directory in which the emd files exist. The default
glob_search will search this directory and all subdirectories.</p>
</dd>
<dt><strong>glob_search</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, default “<a href="#id5"><span class="problematic" id="id6">**</span></a>/<a href="#id7"><span class="problematic" id="id8">*</span></a>”</span></dt>
<dd><p class="first last">Glob search string, see glob for more details:
<a class="reference external" href="https://docs.python.org/2/library/glob.html">https://docs.python.org/2/library/glob.html</a>
Default will search this directory and all subdirectories.</p>
</dd>
<dt><strong>overwrite</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Bool, default True</span></dt>
<dd><p class="first last">Overwrite if the extension_to_save file already exists.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="temul.io.convert_vesta_xyz_to_prismatic_xyz">
<code class="descclassname">temul.io.</code><code class="descname">convert_vesta_xyz_to_prismatic_xyz</code><span class="sig-paren">(</span><em>vesta_xyz_filename, prismatic_xyz_filename, delimiter='   |    |  ', header=None, skiprows=[0, 1], engine='python', occupancy=1.0, rms_thermal_vib=0.05, edge_padding=None, header_comment=&quot;Let's make a file!&quot;, save=True</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.convert_vesta_xyz_to_prismatic_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert from Vesta outputted xyz file format to the prismatic-style xyz
format.
Lose some information from the .cif or .vesta file but okay for now.
Develop your own converter if you need rms and occupancy! Lots to do.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>vesta_xyz_filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">name of the vesta outputted xyz file. See vesta &gt; export &gt; xyz</p>
</dd>
<dt><strong>prismatic_xyz_filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">name to be given to the outputted prismatic xyz file</p>
</dd>
<dt><strong>delimiter, header, skiprows, engine</strong> <span class="classifier-delimiter">:</span> <span class="classifier">pandas.read_csv input parameters</span></dt>
<dd><p class="first last">See pandas.read_csv for documentation
Note that the delimiters here are only available if you use
engine=’python’</p>
</dd>
<dt><strong>occupancy, rms_thermal_vib</strong> <span class="classifier-delimiter">:</span> <span class="classifier">see prismatic documentation</span></dt>
<dd><p class="first last">if you want a file format that will retain these atomic attributes,
use a format other than vesta xyz. Maybe .cif or .vesta keeps these?</p>
</dd>
<dt><strong>header_comment</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">header comment for the file.</p>
</dd>
<dt><strong>save</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Bool, default True</span></dt>
<dd><p class="first last">whether to output the file as a prismatic formatted xyz file with the
name of the file given by “prismatic_xyz_filename”.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>The converted file format as a pandas dataframe</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>See example_data for the vesta xyz file.
&gt;&gt;&gt; from temul.io import convert_vesta_xyz_to_prismatic_xyz
&gt;&gt;&gt; prismatic_xyz = convert_vesta_xyz_to_prismatic_xyz(
…     ‘example_data/prismatic/example_MoS2_vesta_xyz.xyz’,
…     ‘example_data/prismatic/MoS2_hex_prismatic.xyz’,
…     delimiter=’   |    |  ‘, header=None, skiprows=[0, 1],
…     engine=’python’, occupancy=1.0, rms_thermal_vib=0.05,
…     header_comment=”Let’s do this!”, save=True)</p>
</dd></dl>

<dl class="function">
<dt id="temul.io.create_dataframe_for_xyz">
<code class="descclassname">temul.io.</code><code class="descname">create_dataframe_for_xyz</code><span class="sig-paren">(</span><em>sublattice_list</em>, <em>element_list</em>, <em>x_size</em>, <em>y_size</em>, <em>z_size</em>, <em>filename</em>, <em>header_comment='top_level_comment'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.create_dataframe_for_xyz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.io.create_new_folder">
<code class="descclassname">temul.io.</code><code class="descname">create_new_folder</code><span class="sig-paren">(</span><em>new_folder_name</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.create_new_folder" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a folder in the given directory</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>new_folder_name</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">name of the new folder. It will be created in the current directory</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>Nothing</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.io</span> <span class="k">import</span> <span class="n">create_new_folder</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">create_new_folder</span><span class="p">(</span><span class="s1">&#39;test_folder&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.io.dm3_stack_to_tiff_stack">
<code class="descclassname">temul.io.</code><code class="descname">dm3_stack_to_tiff_stack</code><span class="sig-paren">(</span><em>loading_file</em>, <em>loading_file_extension='.dm3'</em>, <em>saving_file_extension='.tif'</em>, <em>crop=False</em>, <em>crop_start=20.0</em>, <em>crop_end=80.0</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.dm3_stack_to_tiff_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Save an image stack filetype to a different filetype.
For example dm3 to tiff</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">Name of the image stack file</p>
</dd>
<dt><strong>loading_file_extension</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">file extension of the filename</p>
</dd>
<dt><strong>saving_file_extension</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">file extension you wish to save as</p>
</dd>
<dt><strong>crop</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, default False</span></dt>
<dd><p class="first last">if True, the image will be cropped in the navigation space,
defined by the frames given in crop_start and crop_end</p>
</dd>
<dt><strong>crop_start, crop_end</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, default 20.0, 80.0</span></dt>
<dd><p class="first last">the start and end frame of the crop</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>n/a</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p># &gt;&gt;&gt; directory = os.chdir(‘C:/Users/Eoghan.OConnell/Documents/Documents/
# Eoghan UL/PHD/Experimental/Ion implantation experiments/Feb 2019
# SStem data’)
# &gt;&gt;&gt; filename = ‘003_HAADF_movie_300_4nm_MC’
# &gt;&gt;&gt; dm3_stack_to_tiff_stack(filename=filename, crop=True,
# crop_start=20.0, crop_end=30.0)</p>
</dd></dl>

<dl class="function">
<dt id="temul.io.load_data_and_sampling">
<code class="descclassname">temul.io.</code><code class="descname">load_data_and_sampling</code><span class="sig-paren">(</span><em>filename</em>, <em>file_extension=None</em>, <em>invert_image=False</em>, <em>save_image=True</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.load_data_and_sampling" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.io.save_individual_images_from_image_stack">
<code class="descclassname">temul.io.</code><code class="descname">save_individual_images_from_image_stack</code><span class="sig-paren">(</span><em>image_stack</em>, <em>output_folder='individual_images'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.save_individual_images_from_image_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Save each image in an image stack. The images are saved in a new folder.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>image_stack</strong> <span class="classifier-delimiter">:</span> <span class="classifier">rigid registration image stack object</span></dt>
<dd></dd>
<dt><strong>output_folder</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">Name of the folder in which all individual images from
the stack will be saved.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>n/a</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="temul.io.write_cif_from_dataframe">
<code class="descclassname">temul.io.</code><code class="descname">write_cif_from_dataframe</code><span class="sig-paren">(</span><em>dataframe</em>, <em>filename</em>, <em>chemical_name_common</em>, <em>cell_length_a</em>, <em>cell_length_b</em>, <em>cell_length_c</em>, <em>cell_angle_alpha=90</em>, <em>cell_angle_beta=90</em>, <em>cell_angle_gamma=90</em>, <em>space_group_name_H_M_alt='P 1'</em>, <em>space_group_IT_number=1</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.write_cif_from_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>dataframe</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dataframe object</span></dt>
<dd><p class="first last">pandas dataframe containing rows of atomic position information</p>
</dd>
<dt><strong>chemical_name_common</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">name of chemical</p>
</dd>
<dt><strong>cell_length_a, _cell_length_b, _cell_length_c</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">lattice dimensions in angstrom</p>
</dd>
<dt><strong>cell_angle_alpha, cell_angle_beta, cell_angle_gamma</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">lattice angles in degrees</p>
</dd>
<dt><strong>space_group_name_H-M_alt</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">space group name</p>
</dd>
<dt><strong>space_group_IT_number</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-temul.dummy_data">
<span id="dummy-data"></span><h3>Dummy Data<a class="headerlink" href="#module-temul.dummy_data" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="temul.dummy_data.get_model_refiner_one_sublattice_12_vacancies">
<code class="descclassname">temul.dummy_data.</code><code class="descname">get_model_refiner_one_sublattice_12_vacancies</code><span class="sig-paren">(</span><em>image_noise=True</em>, <em>test_element='Ti_2'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.get_model_refiner_one_sublattice_12_vacancies" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.dummy_data.get_model_refiner_one_sublattice_3_vacancies">
<code class="descclassname">temul.dummy_data.</code><code class="descname">get_model_refiner_one_sublattice_3_vacancies</code><span class="sig-paren">(</span><em>image_noise=True</em>, <em>test_element='Ti_2'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.get_model_refiner_one_sublattice_3_vacancies" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.dummy_data.get_model_refiner_one_sublattice_varying_amp">
<code class="descclassname">temul.dummy_data.</code><code class="descname">get_model_refiner_one_sublattice_varying_amp</code><span class="sig-paren">(</span><em>image_noise=False, amplitude=[0, 5], test_element='Ti_2'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.get_model_refiner_one_sublattice_varying_amp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.dummy_data.get_model_refiner_two_sublattices">
<code class="descclassname">temul.dummy_data.</code><code class="descname">get_model_refiner_two_sublattices</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.get_model_refiner_two_sublattices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.dummy_data.get_model_refiner_two_sublattices_refined">
<code class="descclassname">temul.dummy_data.</code><code class="descname">get_model_refiner_two_sublattices_refined</code><span class="sig-paren">(</span><em>n=4</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.get_model_refiner_two_sublattices_refined" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.dummy_data.get_model_refiner_with_12_vacancies_refined">
<code class="descclassname">temul.dummy_data.</code><code class="descname">get_model_refiner_with_12_vacancies_refined</code><span class="sig-paren">(</span><em>image_noise=True</em>, <em>test_element='Ti_2'</em>, <em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.get_model_refiner_with_12_vacancies_refined" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.dummy_data.get_model_refiner_with_3_vacancies_refined">
<code class="descclassname">temul.dummy_data.</code><code class="descname">get_model_refiner_with_3_vacancies_refined</code><span class="sig-paren">(</span><em>image_noise=True</em>, <em>test_element='Ti_2'</em>, <em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.get_model_refiner_with_3_vacancies_refined" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">refiner</span> <span class="o">=</span> <span class="n">get_model_refiner_with_3_vacancies_refined</span><span class="p">()</span>
<span class="go">3 new atoms found! Adding new atom positions.</span>
<span class="go">Changing some atoms</span>
<span class="go">Changing some atoms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">history</span> <span class="o">=</span> <span class="n">refiner</span><span class="o">.</span><span class="n">get_element_count_as_dataframe</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.dummy_data.get_simple_cubic_signal">
<code class="descclassname">temul.dummy_data.</code><code class="descname">get_simple_cubic_signal</code><span class="sig-paren">(</span><em>image_noise=False</em>, <em>amplitude=1</em>, <em>with_vacancies=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.get_simple_cubic_signal" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a test image signal of a simple cubic atomic structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>image_noise</strong> <span class="classifier-delimiter">:</span> <span class="classifier">default False</span></dt>
<dd><p class="first last">If True, will add Gaussian noise to the image.</p>
</dd>
<dt><strong>amplitude</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, list of ints, default 1</span></dt>
<dd><p class="first last">If amplitude is set to an int, that int will be applied to all atoms in
the sublattice.
If amplitude is set to a list, the atoms will be a distribution set by
np.random.randint between the min and max int.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>signal</strong> <span class="classifier-delimiter">:</span> <span class="classifier">HyperSpy 2D</span></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.dummy_data.get_simple_cubic_sublattice">
<code class="descclassname">temul.dummy_data.</code><code class="descname">get_simple_cubic_sublattice</code><span class="sig-paren">(</span><em>image_noise=False</em>, <em>amplitude=1</em>, <em>with_vacancies=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.get_simple_cubic_sublattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a test sublattice of a simple cubic atomic structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>image_noise</strong> <span class="classifier-delimiter">:</span> <span class="classifier">default False</span></dt>
<dd><p class="first last">If True, will add Gaussian noise to the image.</p>
</dd>
<dt><strong>amplitude</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, list of ints, default 1</span></dt>
<dd><p class="first last">If amplitude is set to an int, that int will be applied to all atoms in
the sublattice.
If amplitude is set to a list, the atoms will be a distribution set by
np.random.randint between the min and max int.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>sublattice</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Atomap Sublattice</span></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p># If the amplitude list is:
sublattice = tml.dummy_data.get_simple_cubic_sublattice(</p>
<blockquote>
<div>amplitude=[2, 3])</div></blockquote>
<p># then only amplitudes of 2 will be used, see numpy.random.randint</p>
</dd></dl>

</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to TEMUL Toolkit’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Eoghan O&#39;Connell

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>